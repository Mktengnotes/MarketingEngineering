<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 3 Modelos Estructurales | Marketing Engineering</title>
  <meta name="description" content="Capítulo 3 Modelos Estructurales | Marketing Engineering" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 3 Modelos Estructurales | Marketing Engineering" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Capítulo 3 Modelos Estructurales | Marketing Engineering" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 3 Modelos Estructurales | Marketing Engineering" />
  
  <meta name="twitter:description" content="Capítulo 3 Modelos Estructurales | Marketing Engineering" />
  

<meta name="author" content="Marcel Goic" />


<meta name="date" content="2025-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-probabilísticos.html"/>
<link rel="next" href="apéndices-técnicos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="custom-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Marketing Engineering</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html"><i class="fa fa-check"></i><b>1</b> Modelos de Regresión</a>
<ul>
<li class="chapter" data-level="1.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#conceptos-básicos-de-regresión"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos de regresión</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#notación"><i class="fa fa-check"></i><b>1.1.1</b> Notación</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#mínimos-cuadrados-ordinarios-ols-y-supuestos"><i class="fa fa-check"></i><b>1.2</b> Mínimos Cuadrados Ordinarios (OLS) y supuestos</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#estimación"><i class="fa fa-check"></i><b>1.2.1</b> Estimación</a></li>
<li class="chapter" data-level="1.2.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#propiedades"><i class="fa fa-check"></i><b>1.2.2</b> Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#estrategias-de-modelamiento"><i class="fa fa-check"></i><b>1.3</b> Estrategias de Modelamiento</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#arte-vs.-procedimiento"><i class="fa fa-check"></i><b>1.3.1</b> Arte vs. Procedimiento</a></li>
<li class="chapter" data-level="1.3.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#aprendizajes-preliminares"><i class="fa fa-check"></i><b>1.3.2</b> Aprendizajes Preliminares</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#evaluación-de-modelos"><i class="fa fa-check"></i><b>1.4</b> Evaluación de modelos</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#qué-buscamos-en-un-modelo"><i class="fa fa-check"></i><b>1.4.1</b> ¿Qué buscamos en un modelo?</a></li>
<li class="chapter" data-level="1.4.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#ajuste-por-métricas-generales"><i class="fa fa-check"></i><b>1.4.2</b> Ajuste por métricas generales</a></li>
<li class="chapter" data-level="1.4.3" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#ajuste-basado-en-la-probabilidad"><i class="fa fa-check"></i><b>1.4.3</b> Ajuste basado en la probabilidad</a></li>
<li class="chapter" data-level="1.4.4" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#errores-dentro-y-fuera-de-la-muestra"><i class="fa fa-check"></i><b>1.4.4</b> Errores dentro y fuera de la muestra</a></li>
<li class="chapter" data-level="1.4.5" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#división-de-datos"><i class="fa fa-check"></i><b>1.4.5</b> División de datos</a></li>
<li class="chapter" data-level="1.4.6" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#validación-cruzada"><i class="fa fa-check"></i><b>1.4.6</b> Validación cruzada</a></li>
<li class="chapter" data-level="1.4.7" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#test-de-hipótesis"><i class="fa fa-check"></i><b>1.4.7</b> Test de hipótesis</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#usos-y-limitaciones-del-análisis-de-regresión"><i class="fa fa-check"></i><b>1.5</b> Usos y limitaciones del análisis de regresión</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#aprendizaje-de-los-parámetros"><i class="fa fa-check"></i><b>1.5.1</b> Aprendizaje de los parámetros</a></li>
<li class="chapter" data-level="1.5.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#interpretación-de-los-coeficientes"><i class="fa fa-check"></i><b>1.5.2</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="1.5.3" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#pronósticos"><i class="fa fa-check"></i><b>1.5.3</b> Pronósticos</a></li>
<li class="chapter" data-level="1.5.4" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#errores-de-pronóstico"><i class="fa fa-check"></i><b>1.5.4</b> Errores de pronóstico</a></li>
<li class="chapter" data-level="1.5.5" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#principios-generales-de-pronóstico"><i class="fa fa-check"></i><b>1.5.5</b> Principios generales de pronóstico</a></li>
<li class="chapter" data-level="1.5.6" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#limitaciones-de-los-modelos-de-regresión"><i class="fa fa-check"></i><b>1.5.6</b> Limitaciones de los modelos de regresión</a></li>
<li class="chapter" data-level="1.5.7" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#modelos-lineales-generalizados"><i class="fa fa-check"></i><b>1.5.7</b> Modelos lineales generalizados</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#alternativas-de-machine-learning-para-la-regresión"><i class="fa fa-check"></i><b>1.6</b> Alternativas de Machine Learning para la regresión</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#qué-es-machine-learning"><i class="fa fa-check"></i><b>1.6.1</b> ¿Qué es Machine Learning?</a></li>
<li class="chapter" data-level="1.6.2" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#la-regresión-cuenta-como-un-modelo-de-ml"><i class="fa fa-check"></i><b>1.6.2</b> ¿La regresión cuenta como un modelo de ML?</a></li>
<li class="chapter" data-level="1.6.3" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#multivariate-adaptive-regression-splines-mars"><i class="fa fa-check"></i><b>1.6.3</b> Multivariate Adaptive Regression Splines (MARS)</a></li>
<li class="chapter" data-level="1.6.4" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#k-nearest-neighbors-regression-knn"><i class="fa fa-check"></i><b>1.6.4</b> K Nearest Neighbors Regression (KNN)</a></li>
<li class="chapter" data-level="1.6.5" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#regression-trees"><i class="fa fa-check"></i><b>1.6.5</b> Regression trees</a></li>
<li class="chapter" data-level="1.6.6" data-path="modelos-de-regresión.html"><a href="modelos-de-regresión.html#bagging-y-random-forests"><i class="fa fa-check"></i><b>1.6.6</b> Bagging y Random forests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html"><i class="fa fa-check"></i><b>2</b> Modelos probabilísticos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#introducción"><i class="fa fa-check"></i><b>2.1</b> Introducción</a></li>
<li class="chapter" data-level="2.2" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-duración"><i class="fa fa-check"></i><b>2.2</b> Modelos de Duración</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-duración-de-tiempo-discreto"><i class="fa fa-check"></i><b>2.2.1</b> Modelos de duración de tiempo discreto</a></li>
<li class="chapter" data-level="2.2.2" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-duración-en-tiempo-continuo-sin-dependencia-en-la-duración"><i class="fa fa-check"></i><b>2.2.2</b> Modelos de duración en tiempo continuo sin dependencia en la duración</a></li>
<li class="chapter" data-level="2.2.3" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-duración-en-tiempo-continuo-con-dependencia-en-la-duración"><i class="fa fa-check"></i><b>2.2.3</b> Modelos de duración en tiempo continuo con dependencia en la duración</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-conteo"><i class="fa fa-check"></i><b>2.3</b> Modelos de Conteo</a></li>
<li class="chapter" data-level="2.4" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-elección-binaria-binomial"><i class="fa fa-check"></i><b>2.4</b> Modelos de Elección Binaria binomial</a></li>
<li class="chapter" data-level="2.5" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#heterogeneidad-observable"><i class="fa fa-check"></i><b>2.5</b> Heterogeneidad observable</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-duración-en-tiempo-discreto"><i class="fa fa-check"></i><b>2.5.1</b> Modelos de duración en tiempo discreto</a></li>
<li class="chapter" data-level="2.5.2" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-duración-en-tiempo-continuo-sin-dependencia-de-la-duración"><i class="fa fa-check"></i><b>2.5.2</b> Modelos de duración en tiempo continuo sin dependencia de la duración</a></li>
<li class="chapter" data-level="2.5.3" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-duración-en-tiempo-continuo-con-dependencia-de-la-duración"><i class="fa fa-check"></i><b>2.5.3</b> Modelos de duración en tiempo continuo con dependencia de la duración</a></li>
<li class="chapter" data-level="2.5.4" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-conteo-1"><i class="fa fa-check"></i><b>2.5.4</b> Modelos de Conteo</a></li>
<li class="chapter" data-level="2.5.5" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelos-de-elección-binaria-binomial-1"><i class="fa fa-check"></i><b>2.5.5</b> Modelos de Elección Binaria binomial</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#esperanzas-condicionales"><i class="fa fa-check"></i><b>2.6</b> Esperanzas Condicionales</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelo-de-tiempo-discreto-combinado-con-beta"><i class="fa fa-check"></i><b>2.6.1</b> Modelo de Tiempo Discreto (Combinado con Beta)</a></li>
<li class="chapter" data-level="2.6.2" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelo-de-tiempo-continuo-combinado-con-gamma"><i class="fa fa-check"></i><b>2.6.2</b> Modelo de Tiempo Continuo (Combinado con Gamma)</a></li>
<li class="chapter" data-level="2.6.3" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelo-de-conteo-combinado-con-gamma"><i class="fa fa-check"></i><b>2.6.3</b> Modelo de Conteo (Combinado con Gamma)</a></li>
<li class="chapter" data-level="2.6.4" data-path="modelos-probabilísticos.html"><a href="modelos-probabilísticos.html#modelo-de-elección-binaria-binomial-combinado-con-beta"><i class="fa fa-check"></i><b>2.6.4</b> Modelo de Elección Binaria binomial (Combinado con Beta)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html"><i class="fa fa-check"></i><b>3</b> Modelos Estructurales</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#introducción-a-modelos-estructurales"><i class="fa fa-check"></i><b>3.1</b> Introducción a Modelos Estructurales</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#introducción-1"><i class="fa fa-check"></i><b>3.1.1</b> Introducción</a></li>
<li class="chapter" data-level="3.1.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelos-estructurales-en-marketing"><i class="fa fa-check"></i><b>3.1.2</b> Modelos Estructurales en Marketing</a></li>
<li class="chapter" data-level="3.1.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#taxonomía-de-modelos-estructurales"><i class="fa fa-check"></i><b>3.1.3</b> Taxonomía de Modelos Estructurales</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#logit"><i class="fa fa-check"></i><b>3.2</b> Logit</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelos-de-elección-discreta"><i class="fa fa-check"></i><b>3.2.1</b> Modelos de Elección Discreta</a></li>
<li class="chapter" data-level="3.2.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelo-logit"><i class="fa fa-check"></i><b>3.2.2</b> Modelo Logit</a></li>
<li class="chapter" data-level="3.2.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#estimación-1"><i class="fa fa-check"></i><b>3.2.3</b> Estimación</a></li>
<li class="chapter" data-level="3.2.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#modelos-de-panel-persistencia-y-dependencia-temporal"><i class="fa fa-check"></i><b>3.2.4</b> Modelos de Panel: Persistencia y Dependencia Temporal</a></li>
<li class="chapter" data-level="" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#apéndice"><i class="fa fa-check"></i>Apéndice</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#probit"><i class="fa fa-check"></i><b>3.3</b> Probit</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#definición"><i class="fa fa-check"></i><b>3.3.1</b> Definición</a></li>
<li class="chapter" data-level="3.3.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#patrones-de-substitución"><i class="fa fa-check"></i><b>3.3.2</b> Patrones de substitución</a></li>
<li class="chapter" data-level="3.3.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#identificación"><i class="fa fa-check"></i><b>3.3.3</b> Identificación</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#nested-logit"><i class="fa fa-check"></i><b>3.4</b> Nested Logit</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#introducción-2"><i class="fa fa-check"></i><b>3.4.1</b> Introducción</a></li>
<li class="chapter" data-level="3.4.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#estructura-del-modelo"><i class="fa fa-check"></i><b>3.4.2</b> Estructura del Modelo</a></li>
<li class="chapter" data-level="3.4.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#probabilidades-de-elección"><i class="fa fa-check"></i><b>3.4.3</b> Probabilidades de Elección</a></li>
<li class="chapter" data-level="3.4.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#propiedades-y-patrones-de-sustitución"><i class="fa fa-check"></i><b>3.4.4</b> Propiedades y Patrones de Sustitución</a></li>
<li class="chapter" data-level="3.4.5" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#ejemplo"><i class="fa fa-check"></i><b>3.4.5</b> Ejemplo</a></li>
<li class="chapter" data-level="3.4.6" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#estimación-2"><i class="fa fa-check"></i><b>3.4.6</b> Estimación</a></li>
<li class="chapter" data-level="3.4.7" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#extensiones-nested-logit-con-múltiples-niveles"><i class="fa fa-check"></i><b>3.4.7</b> Extensiones: Nested Logit con Múltiples Niveles</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#mixed-logit"><i class="fa fa-check"></i><b>3.5</b> Mixed Logit</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#introducción-y-motivación"><i class="fa fa-check"></i><b>3.5.1</b> Introducción y Motivación</a></li>
<li class="chapter" data-level="3.5.2" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#especificación-del-modelo"><i class="fa fa-check"></i><b>3.5.2</b> Especificación del Modelo</a></li>
<li class="chapter" data-level="3.5.3" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#propiedades-del-mixed-logit"><i class="fa fa-check"></i><b>3.5.3</b> Propiedades del Mixed Logit</a></li>
<li class="chapter" data-level="3.5.4" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#disposición-a-pagar-willingness-to-pay"><i class="fa fa-check"></i><b>3.5.4</b> Disposición a Pagar (Willingness to Pay)</a></li>
<li class="chapter" data-level="3.5.5" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#inferencia-individual-conditionalposterior-means"><i class="fa fa-check"></i><b>3.5.5</b> Inferencia Individual: Conditional/Posterior Means</a></li>
<li class="chapter" data-level="3.5.6" data-path="modelos-estructurales.html"><a href="modelos-estructurales.html#ejemplo-1"><i class="fa fa-check"></i><b>3.5.6</b> Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="apéndices-técnicos.html"><a href="apéndices-técnicos.html"><i class="fa fa-check"></i><b>4</b> Apéndices Técnicos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="apéndices-técnicos.html"><a href="apéndices-técnicos.html#métodos-de-estimación-y-evaluación-de-modelos"><i class="fa fa-check"></i><b>4.1</b> Métodos de Estimación y Evaluación de modelos</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Marketing Engineering</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-estructurales" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Capítulo 3</span> Modelos Estructurales<a href="modelos-estructurales.html#modelos-estructurales" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introducción-a-modelos-estructurales" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introducción a Modelos Estructurales<a href="modelos-estructurales.html#introducción-a-modelos-estructurales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introducción-1" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Introducción<a href="modelos-estructurales.html#introducción-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En esencia, un modelo econométrico estructural es aquel que deriva relaciones estimables estadísticamente a partir de supuestos bien definidos de comportamiento de los agentes que deciden respecto a las cantidades observables. En contraposición a los modelos estructurales están los modelos de forma reducida donde los modelos simplemente describen la variabilidad de alguna medida de interés en base a un conjunto de variables observables exógenas.</p>
<p>La disciplina económica suele llamar modelos estructurales a los resultantes de asumir que los consumidores maximizan una utilidad subyacente y que las firmas maximizan su rentabilidad esperada. Desde el marketing, se considera también en la definición aquellos que postulan hipótesis alternativas de comportamiento incluyendo así una variedad de teorías de comportamiento que nutren la disciplina tales como teoría de prospectos, contabilidad mental, elección sobre conjuntos de consideración, etc. Como se discutirá más adelante, no existe un modelo estructural puro y la línea que los separa de los modelos de forma reducida es ciertamente difusa.</p>
<p>Se incluirá en la discusión de modelos estructurales a cualquiera que considere alguna historia de comportamiento que permita añadir interpretabilidad a los parámetros del modelo.</p>
<p><strong>Ejemplo 1:</strong> Supóngase que un analista busca estudiar cómo el precio en la región <span class="math inline">\(i\)</span> <span class="math inline">\((p_i)\)</span> se ve afectado por la presencia o no de competencia. Si además de los precios se observa la cantidad de clientes en la región <span class="math inline">\((POP_i)\)</span>, el ingreso per cápita en la región <span class="math inline">\((INC_i)\)</span> y una indicatriz <span class="math inline">\(CMP_i\)</span> que toma el valor 1 si en la región correspondiente presenta competencia (0 en caso contrario).</p>
<p>Entonces, un modelo de forma reducida sencillo para estudiar el problema viene dado por:</p>
<p><span class="math display">\[p_i = \beta_0+ \beta_1POP_i + \beta_2INC_i + \beta_3CMP_i + \varepsilon_i\]</span>
Bajo este enfoque, se pueden usar técnicas de regresión tradicionales para estimar <span class="math inline">\(\beta_3\)</span> que en principio indicaría el impacto de la competencia en el nivel de precios. Sin embargo, la presencia de competencia en un determinado mercado depende también del nivel de precios. Si los precios en una región son altos, la rentabilidad esperada por entrar también es alta motivando a potenciales competidores a participar. En consecuencia, un modelo como el planteado podría subestimar
el efecto de la competencia.</p>
<p>Un modelo estructural buscaría derivar relaciones estimables a partir de supuestos básicos del comportamiento de la firma. Por ejemplo, se podría asumir que cada firma decide conjuntamente la entrada/salida de un mercado y los precios a cobrar de modo de maximizar la rentabilidad esperada.</p>
<p><strong>Ejemplo 2:</strong> Supóngase que se busca describir la productividad de los miembros de la fuerza de venta medida como número de unidades vendidas <span class="math inline">\(q\)</span>.</p>
<p><span class="math display">\[q=f(X,\beta)+\varepsilon\]</span></p>
<p>La especificación del término de error <span class="math inline">\(\varepsilon\)</span> puede por sí solo permitir dar una interpretación estructural a los estimadores. Si simplemente se asume un error normalmente distribuido, entonces corresponderá simplemente a un ruido blanco y la regresión simplemente indicará a través de los parámetros <span class="math inline">\(\beta\)</span> cómo las variables <span class="math inline">\(X\)</span> en promedio afectan las ventas <span class="math inline">\(q\)</span>. Por el contrario, si se asume que el término <span class="math inline">\(\varepsilon\)</span> considera además del ruido una componente no observable positiva asociada a la brecha de productividad de los miembros menos eficientes de la fuerza de venta, entonces la regresión describirá la frontera eficiente de ventas. Esto puede hacerse por ejemplo especificando que <span class="math inline">\(\varepsilon = \epsilon - \xi\)</span> donde <span class="math inline">\(\epsilon\)</span> está normalmente distribuida centrada en cero, pero <span class="math inline">\(\xi\)</span> proviene de una normal truncada en los números positivos (este enfoque se le suele llamar de regresión estocástica de frontera).</p>
<p>El gran desafío de la aplicación de modelos econométricos a problemas comerciales es enriquecer el conocimiento respecto a cómo se comportan los agentes relevantes del negocio, para así tomar decisiones más consistentes y más rentables. Desde este punto de vista, se apunta a modelos que describan la lógica que determina el comportamiento de los clientes y firmas más allá de simples correlaciones estadísticas entre las variables observables. En general, son varias las ventajas de usar modelos estructurales por sobre modelos de forma reducida:</p>
<ol style="list-style-type: decimal">
<li><p><em>La capacidad de contar una mejor historia del comportamiento de los agentes</em>. Esto se expresa por la capacidad de interpretación directa de los parámetros del modelo. Mientras los parámetros asociados a enfoques de regresión tradicionales típicamente indican la magnitud en que en promedio varía alguna magnitud de interés ante variaciones de otra, los parámetros de un modelo estructural indican entre otros la valoración relativa de un atributo en la función de utilidad, los precios de referencia de un producto o la aversión al riesgo de un tomador de decisión. La provisión de una historia de comportamiento más completa no se deriva exclusivamente de la interpretación directa de los parámetros del modelo sino que también de la capacidad de derivar métricas complementarias tales como elasticidades y excedentes de consumidores. Más aún, se puede proyectar el comportamiento para calcular probabilidades y frecuencias de compra, participaciones de mercado, etc.</p></li>
<li><p>La generación de estimaciones consistentes con las expectativas de los analistas. Frecuentemente, al analizar los datos se quiere dejar la mayor libertad posible al modelo <em>para dejar que la data hable</em>. Este enfoque puede tener valor y ser recomendable en estudios exploratorios, pero para tomar decisiones se necesitan estimaciones robustas y usar tanta información como sea posible. Las teorías usadas para derivar modelos econométricos estructurales suelen estar soportadas tanto por estudios experimentales como por amplia evidencia empírica en múltiples dominios. Por lo tanto, al incorporar teoría se está implícitamente usando información que ha demostrado consistentemente su validez.</p></li>
</ol>
<p><strong>Ejemplo 3:</strong> Supóngase que se quiere proponer un modelo que describa la participación de mercado de las distintas marcas en una industria. Si se usa un enfoque de regresión en que simplemente se disponen los <em>shares</em> al lado izquierdo y una forma funcional flexible al lado derecho, el modelo resultante podría predecir participaciones fuera del rango [0,1], que difícilmente pueden justificarse. Por el contrario si se adscribe al axioma de elección de Luce (1959) que indica que la probabilidad de elección en un determinado conjunto depende del ratio entre una medida de atracción de la alternativa con respecto al atractivo total del conjunto, se fuerza a que las participaciones siempre estén en el rango deseado.</p>
<p><strong>Ejemplo 4:</strong> La teoría económica predice que en general, las cantidades demandadas decrecen ante aumentos en su precio. Sin embargo, en muchas situaciones prácticas la disponibilidad de datos al nivel de agregación requerido es limitada dificultando la estimación de esta relación inversa entre precio y demanda. En estas situaciones no es raro que un modelo flexible prediga que la demanda crece en función del precio. Agregar estructura permite limitar la búsqueda solo entre aquellos modelos que son consistentes con la premisa de que las demandas decrecen en el precio.</p>
<ol start="3" style="list-style-type: decimal">
<li><em>Evaluación de impacto de modificación de políticas</em>. Una de las herramientas fundamentales de la función comercial es la generación de planes comerciales que buscan proponer un diseño del conjunto producto, plaza, precio y promoción que genere el mayor valor para el cliente y la captura del mayor excedente por parte de la firma. El rol de los modelos econométricos es estudiar el impacto que tendrían distintas estrategias en el comportamiento del consumidor. En esencia, un plan de marketing propone un cambio en las reglas del juego que han generado la data que se observa y por tanto se necesita apuntar a estimar los elementos más básicos del comportamiento que se mantendrán invariantes ante modificación de productos, precios, canales de distribución, etc. En este grupo se tienen valoraciones por atributos de productos, costo de transporte, aversión al riesgo, entre otros, que no pueden ser estimados a menos que se derive el modelo a partir de teorías individuales de comportamiento. En otras palabras, la derivación de modelos de demanda a partir de teorías de comportamiento permite evaluar contrafactuales que apoyan el diseño de propuestas de valor efectivas.</li>
</ol>
<p>La necesidad de evaluar contrafactuales usando elementos fundamentales que no se vean afectados por cambios en los sistemas fue inicialmente discutida por Robert Lucas (1976) en la famosa crítica que lleva su nombre. En el contexto de la predicción de efectos macroeconómicos, Lucas postuló que cualquier cambio en las políticas variaría sistemáticamente la estructura de los modelos y por tanto se debe apuntar a describir parámetros profundos que gobiernan el comportamiento individual.</p>
<p><strong>Ejemplo 5:</strong> Considere un retailer que vende múltiples productos a través de dos canales, las salas de venta tradicionales y un sitio web con despacho directo. El retailer está evaluando la posibilidad de reasignar el conjunto de productos que vende a través de cada canal para aumentar la rentabilidad del negocio. Para apoyar esta decisión, parece evidente que el simple análisis de las ventas de cada producto en cada canal no ayudará a predecir cómo dichos productos se venderían en el otro canal o cómo se afectaría la venta si un producto deja de venderse en algunos de los canales. Para hacer este ejercicio necesariamente se deberá investigar primitivas más fundamentales del comportamiento como preferencias intrínsecas por canal para cada categoría y patrones de sustitución entre las alternativas disponibles dentro del canal y con respecto al otro canal.</p>
<p><strong>Ejemplo 6:</strong> En muchas industrias como la de vestuario de moda o de artículos tecnológicos, hay una alta variabilidad de la oferta con constantes entradas y salidas de diferentes versiones de los productos dificultando la proyección del desempeño de cada variante en el tiempo. Mientras el surtido de producto varía con frecuencia, hay parámetros de la demanda que pueden perdurar por varias temporadas tales como la elasticidad al precio, crecimiento de la categoría, factores estacionales y de sustitución/complementariedad de atributos. Un enfoque estructural apunta precisamente a la estimación de estos parámetros estables.</p>
<ol start="4" style="list-style-type: decimal">
<li><em>Testear aplicabilidad de teoría</em>. Al usar un enfoque estructural, se fuerza a pensar detalladamente respecto al problema y explicitar cada uno de los supuestos de comportamiento. Las especificaciones alternativas de modelos de forma reducida simplemente corresponden a formas funcionales diferentes y por tanto no son informativas respecto a la lógica en que deciden los agentes. Por otra parte, dos modelos estructurales diferentes provienen de supuestos de comportamiento diferentes y por tanto cuando uno de ellos ajusta mejor a la data indica que hay una teoría de comportamiento que es más plausible que la otra en el dominio de aplicación del modelo. Así, los modelos estructurales no solo se nutren de teoría sino que también ayudan a su desarrollo.</li>
</ol>
<p>Las ventajas antes descritas no implican que siempre deban preferirse modelos estructurales por sobre los de forma reducida. Como se ha descrito, los modelos de forma reducida suelen proveer suficiente flexibilidad para dejar que sea la data la que hable, lo que puede ser particularmente útil en análisis exploratorios del caso bajo estudio. Además, muchas veces la inclusión de más estructura en el modelo implica rutinas de estimación más sofisticadas siendo con frecuencia altamente intensivas computacionalmente.</p>
<p>Es importante destacar que no existe un modelo puramente estructural. Todo modelo requiere en algún momento suponer alguna forma funcional flexible sin fundamento teórico sólido. Por ejemplo, se puede asumir que los consumidores al elegir un producto están maximizando una utilidad subyacente, pero ¿cómo describir dicha función de utilidad? ¿Qué variables explicativas usar y cuál forma funcional escoger? Ciertamente la especificidad de las teorías disponibles no alcanza a responder a estas preguntas y se debe por lo tanto escoger en base a la intuición y empíricamente entre aquellas que generen mejor ajuste y/o capacidad de pronóstico. De esta forma, un buen modelo debe balancear adecuadamente el uso de la teoría con la simpleza y flexibilidad del modelo.</p>
<p>Para ser convincente, un modelo estructural debe al menos (i) entregar suficiente flexibilidad para aprender de la data, (ii) derivar las ecuaciones de comportamiento de supuestos razonables respecto de los agentes involucrados y (iii) incorporar explícitamente en la descripción la naturaleza no experimental de la data.</p>
<p><strong>Observación:</strong> En la discusión se ha hecho la distinción entre modelos probabilísticos y modelos estructurales. Aunque los modelos probabilísticos proveen una historia de comportamiento de los agentes, los supuestos básicos usados para derivarlos no se sustentan en ninguna teoría de comportamiento. Por ejemplo, en modelos de duración en tiempo discreto se suele suponer que los clientes dejan de estar activos con cierta probabilidad. Más que una teoría de comportamiento esto es simplemente una descripción probabilística de un fenómeno. En determinadas situaciones, especialmente en casos en que no se dispone de una descripción rica del ambiente en que los agentes toman sus decisiones, se conforma con esta descripción agregada del comportamiento. El enfoque estructural sobre el que se ahondará en esta parte resulta particularmente útil cuando se tiene suficiente información para investigar las motivaciones profundas de las elecciones. Al definir un modelo estructural, tanto las teorías de comportamiento como la descripción probabilística del sistema son fuentes válidas de estructura. Sin embargo, se considerará como modelo econométrico estructural a aquellos que se nutren de ambas fuentes.</p>
</div>
<div id="modelos-estructurales-en-marketing" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Modelos Estructurales en Marketing<a href="modelos-estructurales.html#modelos-estructurales-en-marketing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El desarrollo de modelos estructurales se ha gestado en varias áreas del conocimiento tales como economía, transportes, logística, finanzas y marketing. Entre estas áreas, la del marketing se ha constituido en un terreno particularmente fértil para el desarrollo y adopción del enfoque estructural. Se identifican al menos cuatro motivos por los cuales la adición de estructura en los modelos econométricos es particularmente útil para el análisis de problemas comerciales:</p>
<ol style="list-style-type: decimal">
<li><p><em>Disponibilidad de datos</em>. Gran parte de los datos que registran las compañías dan cuenta de las interacciones entre clientes y firma como son ocasiones de compra, visitas a sitios web corporativos o llamadas a los centros de llamadas. De esta forma, un conjunto importante de los datos disponibles dentro de las organizaciones son informativos respecto a procesos claves de la función comercial. Así, los requerimientos de datos impuestos por los modelos estructurales están inmediatamente satisfechos por procesos operacionales.</p></li>
<li><p><em>Atractivo de la evaluación de la intervención de sistemas</em>. En la función comercial, casi por definición se busca perturbar los sistemas para mejorar la oferta de valor cambiando precios, proponiendo nuevos diseños de productos, redefiniendo la cadena logística, etc. De esta forma se necesita disponer de modelos que describan la reacción de los consumidores ante dichos cambios del ambiente competitivo lo que, de acuerdo a la crítica de Lucas, solo puede hacerse con un modelo estructural.</p></li>
<li><p><em>Importancia de heterogeneidad</em>. En marketing se busca hacer inferencia desagregada a nivel de cliente o segmento para poder diseñar versiones especializadas del marketing mix que sean atractivas para segmentos específicos de clientes. Como los modelos estructurales requieren especificar los supuestos de comportamiento a nivel individual, la generación de estimaciones desagregadas suele derivarse directamente.</p></li>
<li><p><em>Pragmatismo en la aceptación de teorías</em>. Como se ha argumentado, una de las ventajas de los modelos estructurales es que permiten testear si una determinada teoría de comportamiento aplica a una situación. A diferencia de otras disciplinas, en marketing hay una tradición de revisión continua de las fuerzas que moldean el comportamiento de las personas y por tanto el enfoque de modelos estructurales entrega una herramienta alternativa a la verificación experimental de nuevas teorías.</p></li>
</ol>
</div>
<div id="taxonomía-de-modelos-estructurales" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Taxonomía de Modelos Estructurales<a href="modelos-estructurales.html#taxonomía-de-modelos-estructurales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Metodológicamente, es útil generar una clasificación de los tipos de modelos estructurales existentes en la literatura. Como se ha consignado, uno de los costos de la inclusión de teoría en modelos econométricos es la mayor complejidad en las rutinas de estimación. Es esta complejidad la que dificulta la generación de un mecanismo único que permita estimar modelos generales y por tanto se ve forzado a usar metodologías específicas dependiendo de la naturaleza del problema. En la discusión se basará la clasificación en la evaluación de cuatro factores.</p>
<ol style="list-style-type: decimal">
<li><p><em>Nivel de agregación de los datos</em>. Se ha propuesto que un modelo estructural debe basarse en una descripción detallada de los supuestos de los tomadores de decisión a nivel individual. Por lo tanto, la disponibilidad de datos a nivel individual como la decisión de compra de cada uno de los individuos de un panel de consumidores habilita para, imponiendo las restricciones de identificación necesarias, estimar los parámetros de comportamiento de manera más o menos directa. Sin embargo, en ciertas situaciones solo se dispone de información agregada, como participaciones de mercado o datos agregados de venta. En estos casos, la identificación de parámetros de comportamiento requiere además de una descripción del mecanismo mediante el cual se agregan las decisiones individuales. Este mecanismo típicamente considera la especificación de un modelo de heterogeneidad describiendo como se distribuyen los parámetros entre los clientes la que se integra sobre la población para generar las métricas agregadas. Esto es precisamente lo propuesto por el método BLP (a partir de
Berry, Levinsohn y Pakes, quienes primero propusieron el método en 1995) que describe un método que, basado en un modelo logit, permite estimar ofertas y demandas de un modelo oligopólico con información agregada. Por simplicidad, en esta versión se concentrará en modelos estimables directamente sobre datos desagregados a nivel individual.</p></li>
<li><p><em>Temporalidad de las decisiones</em>. Dependiendo de la amplitud temporal considerada por los agentes al evaluar las alternativas de decisión, se distingue entre problemas estáticos y dinámicos. Básicamente, si se considera que las acciones que se observan resultan de una evaluación completa del horizonte, entonces se habla de problemas dinámicos. En caso contrario, se dice que el problema es estático. La distinción es importante desde un punto de vista metodológico. Si el tomador de decisiones basa sus decisiones exclusivamente
mirando el pasado, entonces estas decisiones pueden caracterizarse directamente mediante condiciones de optimidad sencillas. Por el contrario, si el tomador de decisión además evalúa las repercusiones (inciertas) que sus acciones de hoy podrían tener en su bienestar futuro, entonces se necesita caracterizar las políticas óptimas a través de ecuaciones de Bellman que incorporen explícitamente la naturaleza multiperiodo del problema. En este caso, para encontrar la política óptima del problema se requiere usar técnicas como programación dinámica estocástica o control óptimo, aumentando de manera importante la complejidad computacional de la estimación.</p></li>
<li><p><em>Naturaleza de las variables de decisión</em>. Si las variables sobre las que deciden los agentes son continuas (gasto, montos de inversión, unidades compradas, etc.), se habla de un modelo de decisión continuo. Si las variables sobre las que deciden los agentes son discretas (si visita o no visita la tienda, si elige la marca A o marca B, etc.), se habla de un modelo de decisión discreto. La distinción es relevante en cuanto las soluciones de un problema de decisión continua pueden caracterizarse directamente mediante condiciones de Karush-Kuhn-Tucker, mientras que las soluciones de un problema de decisión discreta requieren una enumeración del valor de las alternativas.</p></li>
<li><p><em>Identidad de los agentes</em>. Los modelos estructurales pueden usarse para estudiar tanto el comportamiento de los clientes como de las otras firmas en el mercado. El área que estudia el comportamiento de las firmas ha tenido un gran desarrollo en los últimos años y se conoce como organización industrial empírica. En esta versión, se concentrará la discusión en el estudio de los clientes por dos motivos principales: la disponibilidad de datos de comportamiento de cliente y la simpleza de las nociones de equilibrio requeridas para describir a los clientes. Mientras cada cliente suele tener poco poder de mercado por si mismo, las acciones de marketing de las firmas competidoras típicamente pueden modificar de manera importante las condiciones del mercado. Así, la descripción de las decisiones de las firmas conlleva desafíos metodológicos importantes como la inclusión de nociones sofisticadas de equilibrio para internalizar que las decisiones de las firmas resultan tanto de mirar las respuestas esperadas de los clientes como las reacciones estratégicas de los competidores.</p></li>
</ol>
<p>Metodológicamente es útil también distinguir los métodos de estimación de los modelos. La literatura reconoce dos grandes enfoques para estimar modelos estructurales como los aquí presentados: método de los momentos generalizados (GMM) y método de la máxima verosimilitud. Dada su eficiencia estadística (en el sentido que usa toda la información disponible), en esta primera versión se usará solo el método de la máxima verosimilitud. En lo que sigue se enfocará la discusión al estudio del comportamiento de clientes, en problemas estáticos (o con dinámica limitada a la incorporación del pasado) y con datos desagregados. Partiremos describiendo brevemente modelos de decisión continuos para luego iniciar una discusión más extensa en modelos de decisión discreta que tienen una tradición más larga en marketing.</p>
</div>
</div>
<div id="logit" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Logit<a href="modelos-estructurales.html#logit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="modelos-de-elección-discreta" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Modelos de Elección Discreta<a href="modelos-estructurales.html#modelos-de-elección-discreta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un modelo de elección discreta consiste básicamente en situaciones en que la naturaleza de las variables de decisión a las que se enfrenta el tomador de decisión son discretas. Para ilustrar la intuición de la diferencia con respecto a modelos de decisión continua, es útil pensar que mientras estos últimos buscan describir decisiones de “el cuánto,” los modelos de elección discreta se concentran en “el cuál.” La distinción además relevante desde un punto de vista metodológico. A diferencia de los modelos de elección continua en que la optimidad de la elección queda bien descrita por
condiciones de primer orden, al enfrentar decisiones discretas caracterizaremos la optimidad por enumeración. Ejemplos típicos en que la decisión a evaluar es de naturaleza discreta incluye la elección de una marca por sobre otra en la góndola de un supermercado, la decisión de visitar o no a una tienda, la elección del color de una prenda de vestir, de un canal de venta y la elección de las firmas respecto a entrar o no entrar a un mercado.</p>
<p>Para que un problema de elección discreta esté bien definido, se necesita, además de variables de decisión discretas, que el conjunto de alternativas presente las siguientes tres características:</p>
<ol style="list-style-type: decimal">
<li><p><em>EXHAUSTIVAS</em>: El conjunto sobre el que los tomadores de decisión eligen deben incluir todas las alternativas posibles. En otras palabras, cualquiera sea la decisión observada, debe
estar incluida en el conjunto de elección. Esta condición es poco restrictiva ya que siempre es posible incluir en el set de alternativas la posibilidad “ninguna de las anteriores” o similar que por definición incluya toda las otras posibilidades no consideradas en conjunto. Sin embargo, esta estrategia debe usarse con precaución. Por ejemplo, al estudiar la elección de marca en una categoría en que se observa que los clientes no siempre compran alguna
de las marcas disponibles, se podría incluir la alternativa de no compra en el conjunto de elección. Si la proporción de no compras es alta en la muestra, la inclusión de la alternativa de no compra podría limitar la habilidad del modelo de aprender respecto a cómo los clientes eligen entre marcas. En este caso, podría convenir concentrarse en la elección de la marca condicional en haber hecho una compra en la categoría.</p></li>
<li><p><em>MUTUAMENTE EXCLUYENTES:</em> El conjunto de decisión debe definirse de modo que en cada ocasión el tomador de decisión seleccione solo una de las alternativas disponibles. Esto es, la elección de una alternativa implica necesariamente la no elección de cualquiera de las alternativas restantes. Aunque aparentemente restrictiva, la definición de conjunto de elección puede acomodarse para generar conjuntos mutuamente excluyentes. Por ejemplo, considérese un modelo para describir la elección de los clientes entre la <em>tienda física tradicional</em> o la <em>tienda virtual</em>. Si simplemente se permite una alternativa de elección por cada canal, entonces se excluye la posibilidad de que un mismo cliente esté en más de un canal al mismo tiempo. Para incorporar esta posibilidad, se debe redefinir las alternativas agregando la opción de <em>tienda tradicional y virtual</em>.</p></li>
<li><p><em>FINITO:</em> El conjunto de decisión debe contener un conjunto finito de alternativas. Esta condición es importante por dos motivos técnicos. Primero, un conjunto finito facilita la evaluación de la optimidad de las decisiones y, segundo, facilita la definición de probabilidades de elección. Existen situaciones en que la decisión teóricamente permite infinitas posibilidades, pero que en la práctica se concentran en un número reducido de alternativas y, por tanto, quedan bien representadas por un modelo de elección discreta. Por ejemplo, se puede usar el número de cajas de cereal compradas por los clientes en cada visita al supermercado. Aunque teóricamente los clientes siempre podrían comprar una unidad adicional, el problema queda bien descrito considerando sólo las alternativas de 0, 1, 2, 3 o más de 3 cajas.</p></li>
</ol>
<p>Un modelo estructural para describir la probabilidad de elegir cada alternativa necesita especificar el mecanismo que usan los agentes para decidir entre las alternativas. Se partirá asumiendo que, en cada oportunidad de compra <span class="math inline">\(t\)</span>, el tomador de decisión <span class="math inline">\(n\)</span> elige la alternativa <span class="math inline">\(i\)</span> que le reporta mayor utilidad <span class="math inline">\(u_{nit}\)</span>. Pese a que el tomador de decisión necesita conocer la utilidad que deriva de cada una de las alternativas, desde la perspectiva del analista solo se observan algunas características del ambiente de decisión y del tomador de decisión a partir de las cuales se puede intentar aproximar la utilidad del tomador de decisión a través de una función <span class="math inline">\(v_{nit}(x_{nit}, \theta)\)</span> donde <span class="math inline">\(x_{nit}\)</span> son las características observables del problema y <span class="math inline">\(\theta\)</span> el vector de parámetros que se busca estimar y que describen la relación de dichas características con la utilidad.</p>
<p><strong>Ejemplo:</strong> Supóngase que se quiere describir la elección del medio de pago que usan los usuarios de una tienda determinada, la que permite pagar en efectivo o con alguna tarjeta bancaria. El analista observa 3 variables que intuye pueden ser relevantes en la elección del medio de pago: el género del cliente (<span class="math inline">\(F_n = 1\)</span> si cliente es de género femenino), su nivel de ingresos <span class="math inline">\((I_n)\)</span> y el monto de la transacción <span class="math inline">\((M_{nt})\)</span>. Son precisamente estas características las que estarían incluidas en la matriz que se ha llamado <span class="math inline">\(x_{nit}\)</span>. A partir de esta información pueden plantearse múltiples modelos para describir <span class="math inline">\(v_{nit}\)</span> (se asumirá que <span class="math inline">\(i = 0\)</span> corresponde al caso de pago con efectivo mientras que <span class="math inline">\(i = 1\)</span> al de pago con tarjeta).</p>
<ul>
<li><em>Modelo Lineal Homogéneo</em>: Aquí, la utilidad para ambas alternativas crece linealmente con las variables observables. En este caso, los parámetros son los mismos para todos los tomadores de decisión y por tanto el vector de parámetros viene dado por <span class="math inline">\(\theta = (\alpha_0, \alpha_1, \beta, \gamma, \delta)\)</span></li>
</ul>
<p><span class="math display">\[v_{nit} = \alpha_i + \beta F_n + \gamma I_n + \delta M_{nt}\]</span></p>
<ul>
<li><em>Modelo lineal heterogéneo:</em> Aquí, la utilidad para ambas alternativas también crece linealmente con las variables observables, pero ahora los parámetros varían por alternativa y por agente, y por tanto el vector de parámetros viene dado por <span class="math inline">\(\theta = ( \{ \alpha_{1n} \} _{n=1}^{N}, \beta_0,\beta_1,\gamma_0,\gamma_1,\{ \delta_n \}_{n=1}^{N} )\)</span></li>
</ul>
<p><span class="math display">\[v_{nit} = \alpha_{in} + \beta_i F_n + \gamma_i I_n + \delta_n M_{nt}\]</span></p>
<p>La definición de que los interceptos dependen del cliente <span class="math inline">\(n\)</span> simplemente indica que cada cliente tiene una preferencia intrínseca por cada medio de pago. Del mismo modo, se está imponiendo que la influencia que tiene el monto en el atractivo que tiene cada alternativa depende del cliente. Por ejemplo, mientras para algunos clientes el monto de la transacción puede jugar un rol importante en la decisión del medio de pago, para otros este efecto podría no ser relevante. Por último, la dependencia de la alternativa en los parámetros asociados a género e ingreso podrían usarse para por ejemplo situaciones en que el nivel de ingreso afecta el atractivo de un medio de pago pero no del otro (la intuición para el género es análoga).</p>
<p>Por supuesto, también se pueden postular modelos no lineales u otras especificaciones de la heterogeneidad. Por ejemplo, que la influencia del ingreso varíe por medio de pago, pero que
el efecto del género sea constante entre las alternativas. Descubrir la especificación que mejor describe el problema es precisamente la tarea del analista.</p>
<p><strong>Observación:</strong> En el ejemplo se ha introducido brevemente el concepto de heterogeneidad. Sin embargo, para facilitar la exposición de los temas básicos, en primera instancia se concentrará en modelos sin heterogeneidad. En marketing, los modelos que incluyen heterogeneidad en las preferencias son tan importantes que se postergará su discusión en un capítulo separado.</p>
<p>En la práctica, aún en situaciones en que se observa con detalle el ambiente de decisión, no se podrá describir con exactitud todos los factores que gobiernan el comportamiento de los agentes. Por lo tanto, se definirá <span class="math inline">\(\varepsilon_{nit}\)</span> como el error (aditivo) que se comete al aproximar <span class="math inline">\(u_{nit}\)</span> a través de <span class="math inline">\(v_{nit}\)</span>.</p>
<p><span class="math display">\[u_{nit} = v_{nit} + \varepsilon_{nit}\]</span>
Así, se descompone la utilidad de cada alternativa en una componente sistemática (u observable o explicable) <span class="math inline">\(v_{nit}\)</span> y en una componente aleatoria (o no observable o inexplicable) <span class="math inline">\(\varepsilon_{nit}\)</span>. Como se verá, la tarea de modelamiento del problema involucra tanto la especificación de la componente sistemática como de la aleatoria.</p>
<p>La componente básica para estimar estadísticamente un modelo de elección discreta es la especificación de la probabilidad de elección de cada alternativa. Sea <span class="math inline">\(P_{nit}\)</span> la probabilidad de que el agente <span class="math inline">\(n\)</span> escoja la alternativa <span class="math inline">\(i\)</span> en la oportunidad de compra <span class="math inline">\(t\)</span>. El supuesto de maximización de utilidades implica que <span class="math inline">\(P_{nit}\)</span> puede escribirse como:</p>
<span class="math display">\[\begin{aligned}
P_{nit} &amp;= Pr(u_{nit}&gt;u_{njt},\forall j \neq i)\\
&amp;= Pr(v_{nit} + \varepsilon_{nit} &gt;v_{njt} + \varepsilon_{njt} ,\forall j \neq i)\\
&amp;= \int \textbf{1} (\varepsilon_{njt} - \varepsilon_{nit} &gt; v_{nit} - v_{njt}) f(\varepsilon_{nt}) d \varepsilon_{nt}
\end{aligned}\]</span>
<p>donde <span class="math inline">\(\textbf{1}(\cdot)\)</span> toma el valor 1 si se cumple el argumento y el valor 0 en caso contrario. En esta expresión, <span class="math inline">\(\varepsilon_{nt} = (\varepsilon_{n1t},\varepsilon_{n2t}, ...,\varepsilon_{nIt})\)</span> es el vector de las componentes aleatorias de la elección del agente <span class="math inline">\(n\)</span> en la oportunidad <span class="math inline">\(t\)</span>, y <span class="math inline">\(f(·)\)</span> la función de densidad que describe su comportamiento probabilístico. La elección de la distribución de la componente aleatoria es importante en cuanto impone restricciones a los patrones de comportamiento que pueden ser capturados por el modelo. Se concentrará la atención en los casos en que <span class="math inline">\(\varepsilon_{nit}\)</span> se distribuye valor extremo, que da origen al modelo <em>logit</em>, y normal, que da origen al modelo <em>probit</em>.</p>
</div>
<div id="modelo-logit" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Modelo Logit<a href="modelos-estructurales.html#modelo-logit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo logit resulta de asumir que cada <span class="math inline">\(\varepsilon_{nit}\)</span> es independientemente distribuido de acuerdo a una distribución gumbel o de valor extremo tipo I.</p>
<p><span class="math display" id="eq:logituno">\[\begin{equation} 
  \begin{array}{cc}
  F(\varepsilon_{nit}) = e^{-e^{-\varepsilon_{nit}}}
   &amp;f(\varepsilon_{nit}) = e^{-\varepsilon_{nit}}e^{-e^{-\varepsilon_{nit}}}
   \end{array}
  \tag{3.1}
\end{equation}\]</span></p>
<p>Aplicando esta definición, se puede demostrar que la probabilidad de elección en un modelo logit corresponde a una fórmula cerrada sencilla (para el detalle de la derivación ver <a href="modelos-estructurales.html#apéndice">apéndice</a>):</p>
<p><span class="math display" id="eq:logitprob">\[\begin{equation}
\begin{aligned}
P_{nit} &amp;= \int Pr(\varepsilon_{njt} &lt; v_{nit} - v_{njt} + \varepsilon_{nit}, \forall j \neq i | \varepsilon_{nit}) f(\varepsilon_{nit})d\varepsilon_{nit}\\
&amp;= \int \left(\prod_{j \neq i} e^{-e^{-(v_{nit} - v_{njt} + \varepsilon_{nit})}}\right) e^{-\varepsilon_{nit}}e^{-e^{-\varepsilon_{nit}}}d \varepsilon_{nit} \\
&amp;= \frac{e^{v_{nit}}}{\sum_j e^{v_{njt}}}
\end{aligned}
\tag{3.2}
\end{equation}\]</span></p>
<p>En algunos libros de texto se justifica esta expresión simplemente como una regresión logística, esto es, una transformación lineal para normalizar la utilidad de modo de interpretarla directamente como una probabilidad de elección en el rango [0,1]. Aunque válido, resulta útil entender que, en efecto, dicha expresión puede derivarse a partir de supuestos de maximización de utilidades.</p>
<p>Para ganar algo de intuición respecto a la expresión de la probabilidad de elección, es útil graficarla con respecto a la utilidad derivada por cada alternativa. Por ejemplo, supóngase que se tiene una decisión binaria que, por ejemplo, corresponde a la decisión de comprar o no comprar un producto. En este caso, la probabilidad de comprar el producto crece <em>sigmoidalmente</em> con la utilidad derivada de la compra. Esto es, al graficar la probabilidad de compra con respecto a la utilidad derivada, se obtiene una curva S como muestra la Figura 1. En la figura, se ha agregado también la curva de la probabilidad de elección en el caso en que, en vez de asumir que el error se distribuye valor extremo como demanda el modelo logit, se asume que el error está normalmente distribuido como tradicionalmente se hace en otros modelos econométricos.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="modelos-estructurales.html#cb9-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;images/probabilidad_eleccion.png&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:probelec"></span>
<img src="images/probabilidad_eleccion.png" alt="Probabilidad de elección" width="50%" />
<p class="caption">
Figure 3.1: Probabilidad de elección
</p>
</div>
<p>La disposición de una fórmula cerrada para la probabilidad de elección facilita el cálculo de múltiples métricas asociadas que permiten complementar el análisis. Supóngase que la utilidad de una alternativa viene dada por <span class="math inline">\(v_{nit} = v(x_{nit}, \theta)\)</span>; entonces se pueden calcular:</p>
<ul>
<li>Cómo varía la probabilidad de elegir la alternativa <span class="math inline">\(i\)</span> al variar alguna componente de la utilidad de la misma alternativa.</li>
</ul>
<p><span class="math display" id="eq:ownderivative">\[\begin{equation}
\frac{dP_{nit}}{dx_{nit}}  = \frac{\partial v_{nit}}{\partial x_{nit}} \cdot P_{nit}(1- P_{nit})
\tag{3.3}
\end{equation}\]</span></p>
<ul>
<li>Cómo varía la probabilidad de elegir la alternativa <span class="math inline">\(i\)</span> al variar alguna componente de la utilidad de otra alternativa.</li>
</ul>
<p><span class="math display" id="eq:crossderivative">\[\begin{equation}
\frac{dP_{nit}}{dx_{njt}}  = \frac{\partial v_{njt}}{\partial x_{njt}} \cdot P_{nit}\cdot P_{njt}
\tag{3.4}
\end{equation}\]</span></p>
<ul>
<li>Elasticidad de la probabilidad de elegir la alternativa <span class="math inline">\(i\)</span> con respecto a alguna componente de la utilidad de la misma alternativa.</li>
</ul>
<p><span class="math display" id="eq:ownelasticity">\[\begin{equation}
e_{ix_{nit}} = \frac{\partial P_{nit}}{\partial x_{nit}}  \cdot \frac{x_{nit}}{P_{nit}}= \frac{\partial v_{nit}}{\partial x_{nit}} x_{nit} (1- P_{nit})
\tag{3.5}
\end{equation}\]</span></p>
<ul>
<li>Elasticidad de la probabilidad de elegir la alternativa <span class="math inline">\(i\)</span> con respecto a alguna componente de la utilidad de otra alternativa.</li>
</ul>
<p><span class="math display" id="eq:crosselasticity">\[\begin{equation}
e_{ix_{njt}} = \frac{\partial P_{nit}}{\partial x_{njt}}  \cdot \frac{x_{njt}}{P_{nit}}= \frac{\partial v_{njt}}{\partial x_{njt}} x_{njt} P_{njt}
\tag{3.6}
\end{equation}\]</span></p>
<p>Recuerde que una de las motivaciones para el uso de modelos estructurales es la posibilidad de analizar contrafactuales, esto es, ver qué pasaría con el mercado si hay cambio en alguna variable de control interesante. Por ejemplo que pasa con las participaciones de mercado si sube el precio de una alternativa, si se aumenta la frecuencia publicitaria, etc. Las métricas recién presentadas permiten precisamente hacer dichas evaluaciones de manera directa.</p>
<div id="propiedades-del-modelo-logit" class="section level4 hasAnchor" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Propiedades del modelo Logit<a href="modelos-estructurales.html#propiedades-del-modelo-logit" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El modelo logit es bastante flexible para acomodar una amplia variedad de situaciones. En efecto, distintas especificaciones de las funciones de utilidades de las alternativas permiten describir múltiples fenómenos asociados a la elección. Sin embargo, es importante reconocer que los supuestos subyacentes al logit imponen importantes restricciones a cómo se describe la lógica en que los agentes evalúan las alternativas y escogen entre ellas.</p>
<p>Para fijar ideas, resulta útil pensar qué restricciones impone asumir que las componentes no observables de la utilidad son todas independientes entre ellas. El supuesto de independencia obliga a imponer que cualquier relación entre las utilidades de dos alternativas debe necesariamente capturarse a través de variables observables. Del mismo modo, las utilidades que se derivan por dos alternativas en ocasiones de elección diferentes solo pueden describirse a través de elementos que se puedan observar a lo largo del tiempo. Para entender mejor cómo estas limitaciones se materializan en la formulación del modelo, se discutirán formalmente tres características del modelo logit: la existencia de patrones de sustitución proporcional, la incapacidad de capturar tanto heterogeneidad aleatoria en las preferencias como componentes dinámicas no observables.</p>
<div id="patrones-de-sustitución" class="section level5 unnumbered hasAnchor">
<h5>Patrones de sustitución<a href="modelos-estructurales.html#patrones-de-sustitución" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Los patrones de sustitución derivados de un modelo logit son bastante peculiares y, aunque desde un punto de vista econométrico puede resultar beneficioso, desde el punto de vista de la investigación de teorías de comportamiento suele ser considerado como bastante restrictivo. Se entenderá por patrones de sustitución a la forma en que cambia la probabilidad de elección de alguna alternativa cuando se modifica el atractivo de otra alternativa. Para entender la naturaleza de los patrones de sustitución del modelo logit es útil calcular el ratio de las probabilidades de elección de dos alternativas cualquiera <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span>.</p>
<p><span class="math display">\[\frac{P_{ni}}{P_{nj}} = e^{v_{ni} - v_{nj}}\]</span></p>
<p>Este ratio solo depende de las utilidades observables de las dos alternativas consideradas lo que indica que la probabilidad relativa de elegir la alternativa <span class="math inline">\(i\)</span> sobre la alternativa <span class="math inline">\(j\)</span> no depende de que otras alternativas existan ni de los atributos que ellas tengan. Por ejemplo, si se agrega una alternativa al conjunto de elección, el ratio de probabilidades de las alternativas existentes se mantendrá constante independiente de las características de la nueva alternativa. Se referirá a esta característica como <em>independencia de alternativas irrelevantes</em> o <em>IIA</em>.</p>
<p>Para ejemplificar, considérese una botillería que ofrece dos variedades de vino, uno blanco y otro tinto. Supóngase además que estas dos alternativas tienen la misma participación de
mercado, esto es la mitad de los clientes de la botillería compra vino blanco y la otra mitad compra vino tinto. En este caso, las utilidades sistemáticas debieran ser similares y, por tanto, el ratio de probabilidades de elección de vino blanco sobre vino tinto debiera acercarse a 1. Motivado por un
mayor margen de los vinos tintos, el administrador de la botillería decide incorporar una nueva variedad de vino tinto. Intuitivamente se esperaría que, como la nueva variedad de vino tinto es un sustituto más cercano al tinto existente, la participación de mercado de este debiera decrecer
más que la de vino blanco. Sin embargo, la propiedad de IIA impone que este ratio se mantiene constante. En otras palabras, la introducción de una nueva alternativa disminuirá la participación de todas la otras alternativas independiente de las similitudes que tengan. Esta última observación
puede corroborarse calculando la elasticidad de sustitución <span class="math inline">\(E_{ix_{nj}}\)</span> que determina como cambia la probabilidad de consumir la alternativa <span class="math inline">\(i\)</span> ante un cambio en un atributo <span class="math inline">\(x_{nj}\)</span> de la alternativa <span class="math inline">\(j\)</span>.</p>
<p><span class="math display">\[E_{ix_{nj}} = -\frac{\partial v_{nj}}{\partial x_{nj}}x_{nj} P_{nj}, \forall i \neq j\]</span></p>
<p>Esta expresión no depende de <span class="math inline">\(i\)</span>, por lo que es constante para todas las alternativas de elección. Luego, si ocurre una mejora en los atributos de una alternativa, la probabilidad de elección de las demás disminuye en el mismo porcentaje independiente de la similitud entre alternativas. Se referirá a esta característica como <em>patrones de sustitución proporcionales</em>.</p>
<p>Una ventaja de los patrones de sustitución del modelo logit es que permite que los parámetros del modelo sean estimados consistentemente en base a un subconjunto de las alternativas. Esto es particularmente útil en ambientes de decisión de marketing donde típicamente se encuentran centenas de productos que potencialmente pueden constituir alternativas de elección en una situación de compra. De esta forma, para estimar un modelo logit se pueden seleccionar conjuntos
reducidos de alternativas que capturan los elementos esenciales de la elección e ignorar qué pasa con todas las otras alternativas.</p>
</div>
<div id="incapacidad-de-estimar-componentes-aleatorias" class="section level5 unnumbered hasAnchor">
<h5>Incapacidad de estimar componentes aleatorias<a href="modelos-estructurales.html#incapacidad-de-estimar-componentes-aleatorias" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>La investigación de las diferencias entre las preferencias de los distintos clientes es un tema fundamental para el desarrollo de planes comerciales exitosos. Tradicionalmente se distinguen dos tipos de heterogeneidad de acuerdo a la capacidad de observación del analista. En un principio, se tiene el estudio de heterogeneidad observable que indica cómo las preferencias de los tomadores de decisiones varían de acuerdo a sus características medibles. Este tipo de heterogeneidad permite, por ejemplo, estudiar diferencias en las preferencias entre hombres y mujeres, por edad o por niveles de ingreso. Sin embargo, una proporción importante de las diferencias de las preferencias no es atribuible a características observables como las recién descritas. Otro ejemplo es que dos hermanos del mismo género, de edades similares, viviendo en el mismo hogar, pueden tener preferencias completamente diferentes respecto a sabores de yogur.</p>
<p>El resultado fundamental en esta sección indica que un modelo logit permite estudiar variaciones de preferencias asociadas a componentes observables, pero no a componentes no observables.
Para ilustrar este resultado, supóngase un tomador de decisión caracterizado por la siguiente función de utilidad:</p>
<p><span class="math display">\[u_{nit} = \alpha_i + \beta_np_{it} + \varepsilon_{nit}\]</span></p>
<p>Es decir, la utilidad de cada alternativa tiene una componente base que es constante entre los tomadores de decisión y una penalización por precio <span class="math inline">\(p_{it}\)</span> al que se enfrenta el tomador de decisión. Al indexar <span class="math inline">\(β_n\)</span> por agente se está explícitamente permitiendo que algunos tomadores de decisión sean más sensibles al precio que otros. Supóngase que se postula que el coeficiente de precio viene dado por la siguiente ecuación de regresión.</p>
<p><span class="math display">\[\beta_n = \lambda_0 + \lambda_1I_n + \mu_n\]</span>
Donde <span class="math inline">\(\lambda_0\)</span> captura la sensibilidad base al precio, <span class="math inline">\(I_n\)</span> el nivel de ingreso del agente <span class="math inline">\(n\)</span> y <span class="math inline">\(\lambda_1\)</span> el coeficiente que indica cómo dichos niveles de ingresos afectan la sensibilidad al precio. Por último, <span class="math inline">\(\mu_n\)</span> es un valor aleatorio que captura todas las otras componentes que modifican la sensibilidad al precio más allá del nivel base y los ingresos.</p>
<span class="math display">\[\begin{aligned}
u_{nit} &amp;= \alpha_i + (\lambda_0 + \lambda_1 I_n + \mu_n)p_{it} + \varepsilon_{nit}\\
&amp;= \alpha_i + \lambda_0 p_{it} + \lambda_1p_{it}I_n + \xi_{nit}
\end{aligned}\]</span>
<p>Donde <span class="math inline">\(\xi_{nit} = \mu_np_{it} + \varepsilon_{nit}\)</span>. De esta expresión debiera ser claro que la inclusión de heterogeneidad
observable puede ser capturada bajo un enfoque logit. En efecto, los parámetros <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\lambda_0\)</span> y <span class="math inline">\(\lambda_1\)</span> dan cuenta respectivamente del nivel de utilidad base por alternativa, de la penalización por precio y de como dicha penalización se ve modificada por el nivel de ingresos. Lamentablemente, la
variación aleatoria <span class="math inline">\(\mu_n\)</span> no puede ser incluida, ya que su inclusión necesariamente implica que las componentes errores <span class="math inline">\(\xi_{nit}\)</span> no están idénticamente distribuidas. En efecto, se puede mostrar que <span class="math inline">\(\mathbb{V}ar(\xi_{nit}, \xi_{njt}) = \mathbb{Var}(\mu_n)p^2_{it}\)</span> que evidentemente varía entre alternativas. Más aún, también se puede mostrar que <span class="math inline">\(\mathbb{Cov}(\xi_{nit}, \xi_{njt}) = \mathbb{Var}(\mu_n)p_{it}p_{jt} \neq 0\)</span>, violando también el supuesto de independencia.</p>
<p>Es importante notar que la incapacidad de capturar aleatoriedad aplica también a componentes dinámicas. Esto es, al observar compras repetidas en el tiempo, el modelo logit no permite capturar que hay componentes no observables que varíen en el tiempo. Por ejemplo, no se puede incorporar que, debido a factores externos no observables, en algunos períodos algunas alternativas son más atractivas para todos los agentes decidiendo en dichos períodos. Al igual que en el ejemplo anterior, incluir estas variaciones viola los supuestos de distribuciones independientes e idénticamente distribuidas para las componentes no observables.</p>
</div>
</div>
</div>
<div id="estimación-1" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Estimación<a href="modelos-estructurales.html#estimación-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para estimar el modelo, se necesita escribir la verosimilitud del problema. La componente fundamental para la construcción de la verosimilitud es la descripción de la probabilidad de
elección <span class="math inline">\(P_{nit}\)</span>. Para el caso del modelo logit, como la expresión de la probabilidad de elección corresponde a una fórmula analítica cerrada, la construcción de la verosimilitud es directa. Si la componente determinística de la utilidad viene dada por <span class="math inline">\(v_{nit}(x_{nit}, \theta)\)</span> y si <span class="math inline">\(y_{nit}\)</span> es una variable que toma valor 1 si el tomador de decisión <span class="math inline">\(n\)</span> escoge alternativa <span class="math inline">\(i\)</span> en oportunidad <span class="math inline">\(t\)</span>, entonces la verosimilitud viene dada por:</p>
<p><span class="math display" id="eq:likelihood">\[\begin{equation}
L(\theta) = \prod_n\prod_i\prod_t (P_{nit})^{y_{nit}} =  \prod_n\prod_i\prod_t \left(\frac{e^{v_{nit}(x_{nit},\theta)}}{\sum_j e^{v_{njt}(x_{njt},\theta)}}\right)^{y_{nit}}
\tag{3.7}
\end{equation}\]</span></p>
<p>La que se puede maximizar directamente usando rutinas estándares de programación convexa. Computacionalmente, suele ser más conveniente trabajar con la log-verosimilitud en vez de la verosimilitud. Esto porque la multiplicación de probabilidades genera muy rápidamente valores que computacionalmente son indistinguibles de cero. Recuérdese que el valor de los valores óptimos son invariantes a transformaciones monótonas como la del logaritmo.</p>
<p><span class="math display" id="eq:loglikelihood">\[\begin{equation}
\begin{aligned}
LL(\theta) &amp;= \sum_n\sum_i\sum_t y_{nit} ln \left(\frac{e^{v_{nit}(x_{nit},\theta)}}{\sum_j e^{v_{njt}(x_{njt},\theta)}}\right)\\
&amp;= \sum_n\sum_i\sum_t y_{nit}v_{nit}(x_{nit},\theta) - \sum_n\sum_i\sum_t ln \left(\sum_j e^{v_{njt}(x_{njt},\theta)}\right)
\end{aligned}
\tag{3.8}
\end{equation}\]</span></p>
<p>Como se ha indicado, esta función objetivo puede ser ingresada directamente a cualquier rutina de optimización para encontrar los estimadores máximo verosímiles. Además, para muchas instancias prácticas, es conveniente contar con las derivadas de la log-verosimilitud, de modo de encontrar eficientemente direcciones de máximo ascenso o evaluar si el punto es estacionario o no. Afortunadamente, para la mayoría de las especificaciones del modelo logit, estas derivadas también son fáciles de obtener. Por ejemplo, si la componente sistemática de la utilidad viene dada por <span class="math inline">\(v_{nit}(x_{nit}, \theta) = x&#39;_{nit}\theta\)</span> entonces</p>
<p><span class="math display" id="eq:gradient">\[\begin{equation}
\frac{\partial LL(\theta)}{\partial \theta} = \sum_n\sum_i\sum_t \left(y_{nit} - \frac{e^{x&#39;_{nit}\theta}}{\sum_j e^{x&#39;_{njt}\theta}}\right)x_{nit}
\tag{3.9}
\end{equation}\]</span></p>
<p>Del mismo modo, se pueden calcular segundas derivadas que resultan útiles para el cálculo de errores estándares de los parámetros.</p>
<div id="evaluación-del-modelo" class="section level4 unnumbered hasAnchor">
<h4>Evaluación del modelo<a href="modelos-estructurales.html#evaluación-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Al igual que en otros modelos econométricos, una de las componentes fundamentales del análisis es la evaluación de la calidad del modelo. La variedad de métricas disponibles para la evaluación es muy amplia y la mayoría son transversales a cualquier modelo. Categorizaremos las herramientas de evaluación en tres grupos: bondad de ajuste, capacidad de pronóstico y test de hipótesis.</p>
<ol style="list-style-type: decimal">
<li><p><em>BONDAD DE AJUSTE</em>: Las métricas de bondad de ajuste básicamente nos indican qué tan bien el modelo ajusta a la data. En el contexto de modelos de regresión, se suele analizar el estadístico <span class="math inline">\(R^2\)</span> que mide la proporción de la variabilidad de la variable dependiente que puede ser explicado por la variación de las variables independientes. En el contexto de modelos de elección discreta se basará la evaluación en el valor de la verosimilitud usando alguno o varios de los siguientes indicadores:</p>
<ul>
<li><span class="math inline">\(\rho\)</span> de McFadden. Este índice está en el rango [0,1] e informalmente, se suele interpretar como el coeficiente de determinación <span class="math inline">\((R^2)\)</span> en el sentido que un valor cercano a 0 indica un mal ajuste y un valor cercano a 1 indica un buen ajuste. Sin embargo, es importante notar que no puede decirse que <span class="math inline">\(\rho\)</span> mida la variabilidad explicada por el modelo como
hace el coeficiente de determinación</li>
</ul>
<p><span class="math display" id="eq:rho">\[\begin{equation}
 \rho=1 - \frac{LL(\hat{\beta})}{LL(0)}
 \tag{3.10}
 \end{equation}\]</span></p></li>
</ol>
<ul>
<li>Criterio de información de Akaike (AIC) y Bayesiano (BIC): Una de las limitaciones del <span class="math inline">\(\rho\)</span> de McFadden es que solo permite comparar modelos con el mismo número de parámetros. Los dos indicadores más usados para comparar modelos con distintos números de parámetros son AIC y BIC, en que se penaliza la verosimilitud por el número de parámetros para capturar el hecho de que al incluir nuevos parámetros la verosimilitud necesariamente crecerá. La diferencia entre AIC y BIC es que el primero tiene una penalización constante por número de parámetros mientras que la penalización del segundo depende de la cantidad de datos disponible. Si la log-verosimilitud de un modelo con n observaciones y k parámetros , entonces AIC y BIC vienen dados por:</li>
</ul>
<p><span class="math display" id="eq:aicbic">\[\begin{equation}
\begin{array}{cc}
AIC = -LL(\hat{\theta}) + 2k &amp; BIC =-2LL(\hat{\theta}) + k\ln(n)
\end{array}
\tag{3.11}
\end{equation}\]</span></p>
<ol style="list-style-type: decimal">
<li><em>CAPACIDAD DE PRONÓSTICO</em>: Un modelo que explique muy bien la data puede correr el riesgo de sobreajustar. Esto es, que no permita describir el fenómeno para datos que no se usaron en el entrenamiento del modelo. Para medir la capacidad de pronóstico se suele dividir los datos en un subconjunto de entrenamiento y otro de prueba. Con esto, se comparan las realizaciones con lo pronosticado usando las estimaciones del subconjunto de entrenamiento. Supóngase que se está interesado en evaluar la capacidad de pronóstico de un indicador <span class="math inline">\(f_{ni}\)</span> que puede corresponder a las elecciones mismas, participaciones de mercado o cualquier otra. Si <span class="math inline">\(\hat{f}_{ni}\)</span> es el pronóstico del modelo, entonces se suele usar el mean
absolute error (MAE) o el mean absolute percentage error (MAPE)</li>
</ol>
<p><span class="math display" id="eq:maemape">\[\begin{equation}
\begin{array}{cc}
MAE = \frac{1}{N} \sum_n \sum_i |f_{ni} - \hat{f}_{ni}| &amp;MAPE = \frac{1}{N} \sum_n \sum_i \left| \frac{f_{ni} - \hat{f}_{ni}}{f_{ni}} \right|
\end{array}
\tag{3.12}
\end{equation}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><em>TEST DE HIPÓTESIS</em>: La evaluación de hipótesis también puede contribuir a diagnosticar un modelo. Por ejemplo, al agregar una variable explicativa, se podría evaluar si el coeficiente correspondiente es significativamente diferente de 0, lo que se puede hacer directamente a través de la construcción de intervalos de confianza o su estadístico <span class="math inline">\(t\)</span> equivalente (recuérdese que la varianza del estimador máximo verosímil puede obtenerse usando el inverso del Hessiano). En ocasiones también se estará interesado en testear hipótesis más complejas, para lo que se recurre a test de ratios de verosimilitud. Supóngase, por ejemplo, que se tiene un modelo en que los coeficientes asociados a display difieren por marca para incorporar la posibilidad de que algunas de ellas sean más efectivas en su comunicación en sala. El test de ratios de verosimilitud permite, por ejemplo, testear si estos coeficientes son iguales o si efectivamente difieren entre marcas. Si la hipótesis nula puede expresarse como <span class="math inline">\(k\)</span> restricciones sobre los parámetros, entonces se puede estimar un modelo A no restringido y otro B restringido y se calcula el estadístico <span class="math inline">\(LR = 2(LLA − LLB)\)</span>, que se distribuye <span class="math inline">\(\chi^2\)</span>
con k grados de libertad.</li>
</ol>
</div>
</div>
<div id="modelos-de-panel-persistencia-y-dependencia-temporal" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Modelos de Panel: Persistencia y Dependencia Temporal<a href="modelos-estructurales.html#modelos-de-panel-persistencia-y-dependencia-temporal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hasta ahora se han discutido modelos de elección discreta asumiendo implícitamente que cada observación de elección es independiente de las demás. Sin embargo, cuando se dispone de datos de panel (observaciones repetidas del mismo individuo a lo largo del tiempo), es razonable esperar que las elecciones de un individuo en diferentes períodos estén relacionadas. En contextos de marketing, esta dependencia temporal puede manifestarse de diversas formas, siendo dos de las más relevantes la <strong>persistencia de elección</strong> (o lealtad) y la formación de <strong>precios de referencia</strong>.</p>
<div id="persistencia-de-elección-lealtad" class="section level4 hasAnchor" number="3.2.4.1">
<h4><span class="header-section-number">3.2.4.1</span> Persistencia de Elección (Lealtad)<a href="modelos-estructurales.html#persistencia-de-elección-lealtad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Uno de los fenómenos más documentados en el comportamiento de compra es la tendencia de los consumidores a repetir sus elecciones previas, lo que comúnmente se denomina lealtad de marca o inercia en el comportamiento. Esta persistencia puede originarse en múltiples factores:</p>
<ul>
<li><strong>Costos de cambio:</strong> Tanto físicos (esfuerzo de probar algo nuevo) como psicológicos (aversión al riesgo)</li>
<li><strong>Aprendizaje:</strong> Experiencias positivas pasadas reducen la incertidumbre sobre el producto</li>
<li><strong>Satisfacción acumulada:</strong> La utilidad experimentada en compras previas afecta la percepción actual</li>
<li><strong>Hábito:</strong> Rutinas de compra que simplifican el proceso de decisión</li>
</ul>
<p>Para capturar esta persistencia en un modelo logit, se introduce una variable de <strong>lealtad latente</strong> <span class="math inline">\(z_{nit}\)</span> que representa la propensión no observable del individuo <span class="math inline">\(n\)</span> a elegir la alternativa <span class="math inline">\(i\)</span> en el período <span class="math inline">\(t\)</span>, basada en su historia de elecciones previas.</p>
<p><strong>Modelamiento de la Persistencia:</strong></p>
<p>La utilidad del individuo <span class="math inline">\(n\)</span> por la alternativa <span class="math inline">\(i\)</span> en el período <span class="math inline">\(t\)</span> se especifica como:</p>
<p><span class="math display" id="eq:utilpersist">\[\begin{equation}
u_{nit} = \alpha_i + \beta x_{it} + \gamma z_{nit} + \varepsilon_{nit}
\tag{3.13}
\end{equation}\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(\alpha_i\)</span> es la constante alternativa-específica</li>
<li><span class="math inline">\(x_{it}\)</span> son las covariables observables (precio, promoción, etc.)</li>
<li><span class="math inline">\(\beta\)</span> es el vector de coeficientes asociados a las variables observables</li>
<li><span class="math inline">\(z_{nit}\)</span> es la <strong>lealtad latente</strong> (no observable)</li>
<li><span class="math inline">\(\gamma\)</span> mide el efecto de la persistencia en la elección</li>
<li><span class="math inline">\(\varepsilon_{nit}\)</span> es el término de error i.i.d. valor extremo tipo I</li>
</ul>
<p><strong>Construcción de la Variable de Lealtad:</strong></p>
<p>La variable de lealtad <span class="math inline">\(z_{nit}\)</span> se construye como un promedio ponderado exponencialmente de las elecciones pasadas del individuo. Sea <span class="math inline">\(y_{nit}\)</span> una variable indicadora que toma valor 1 si el individuo <span class="math inline">\(n\)</span> eligió la alternativa <span class="math inline">\(i\)</span> en el período <span class="math inline">\(t\)</span> y 0 en caso contrario. Entonces:</p>
<p><span class="math display" id="eq:loyalty">\[\begin{equation}
z_{nit} = \lambda z_{nit-1} + (1 - \lambda) y_{nit-1}
\tag{3.14}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(0 \leq \lambda \leq 1\)</span> es un <strong>parámetro de decaimiento</strong> que determina qué tan rápido se desvanece el efecto de las elecciones pasadas.
Con <span class="math inline">\(\lambda = 0\)</span> solo importa la elección inmediatamente anterior (<span class="math inline">\(z_{nit} = y_{nit-1}\)</span>) y con <strong><span class="math inline">\(\lambda = 1\)</span>:</strong>, todas las elecciones pasadas tienen el mismo peso (memoria perfecta).</p>
<p>Expandiendo recursivamente la ecuación <a href="modelos-estructurales.html#eq:loyalty">(3.14)</a>:</p>
<span class="math display">\[\begin{aligned}
z_{nit} &amp;= \lambda z_{nit-1} + (1-\lambda) y_{nit-1}\\
&amp;= \lambda[\lambda z_{nit-2} + (1-\lambda)y_{nit-2}] + (1-\lambda)y_{nit-1}\\
&amp;= \lambda^2 z_{nit-2} + \lambda(1-\lambda)y_{nit-2} + (1-\lambda)y_{nit-1}\\
&amp;= \lambda^2[\lambda z_{nit-3} + (1-\lambda)y_{nit-3}] + \lambda(1-\lambda)y_{nit-2} + (1-\lambda)y_{nit-1}\\
&amp;= \lambda^3 z_{nit-3} + \lambda^2(1-\lambda)y_{nit-3} + \lambda(1-\lambda)y_{nit-2} + (1-\lambda)y_{nit-1}\\
&amp;= \vdots\\
&amp;= (1-\lambda)y_{nit-1} + \lambda(1-\lambda)y_{nit-2} + \lambda^2(1-\lambda)y_{nit-3} + \cdots + \lambda^{t-2}(1-\lambda)y_{ni1}\\
&amp;= (1-\lambda)\sum_{s=1}^{t-1} \lambda^{t-1-s} y_{nis}
\end{aligned}\]</span>
<p>Esta expresión muestra que <span class="math inline">\(z_{nit}\)</span> es un promedio ponderado de todas las elecciones pasadas, donde las elecciones más recientes reciben mayor peso exponencialmente decreciente.</p>
<p><strong>Inicialización:</strong></p>
<p>Para el primer período observado, se requiere una condición inicial. Las opciones comunes son:</p>
<ul>
<li><span class="math inline">\(z_{ni1} = 0\)</span> para todas las alternativas</li>
<li><span class="math inline">\(z_{ni1} = 1/J\)</span> donde <span class="math inline">\(J\)</span> es el número de alternativas (distribución uniforme)</li>
<li><span class="math inline">\(z_{ni1}\)</span> basado en participación de mercado agregada</li>
</ul>
<p><strong>Estimación:</strong></p>
<p>El parámetro <span class="math inline">\(\lambda\)</span> puede ser:</p>
<ol style="list-style-type: decimal">
<li><strong>Fijado a priori:</strong> Por ejemplo, <span class="math inline">\(\lambda = 0\)</span> para considerar solo la elección inmediata anterior</li>
<li><strong>Estimado como parte del modelo:</strong> Se incluye <span class="math inline">\(\lambda\)</span> como parámetro adicional a estimar, buscando en una grilla de valores <span class="math inline">\((0, 0.1, 0.2, ..., 0.9)\)</span> o mediante búsqueda numérica</li>
<li><strong>Específico por alternativa:</strong> <span class="math inline">\(\lambda_i\)</span> diferente para cada alternativa, permitiendo que algunas marcas generen más lealtad que otras</li>
</ol>
<p><strong>Interpretación de <span class="math inline">\(\gamma\)</span>:</strong></p>
<p>El coeficiente <span class="math inline">\(\gamma\)</span> mide la magnitud del efecto de la persistencia:</p>
<ul>
<li><strong><span class="math inline">\(\gamma &gt; 0\)</span>:</strong> Existe persistencia positiva - los consumidores tienden a repetir elecciones previas</li>
<li><strong><span class="math inline">\(\gamma = 0\)</span>:</strong> No hay efecto de persistencia - las elecciones son independientes en el tiempo</li>
<li><strong><span class="math inline">\(\gamma &lt; 0\)</span>:</strong> Búsqueda de variedad - los consumidores tienden a cambiar de alternativa</li>
</ul>
<p>En la mayoría de contextos de marketing, se espera <span class="math inline">\(\gamma &gt; 0\)</span>, aunque en categorías donde la variedad es valorada (helados, restaurantes) podría observarse <span class="math inline">\(\gamma &lt; 0\)</span>.</p>
<p><strong>Ejemplo Numérico:</strong></p>
<p>Supóngase un mercado de yogur con 3 marcas (A, B, C) y un consumidor que en los últimos 5 períodos eligió: A, A, B, A, ? (período actual). Con <span class="math inline">\(\lambda = 0.5\)</span>:</p>
Para la marca A:
<span class="math display">\[\begin{aligned}
z_{A,t} &amp;= (1-0.5)[1 \cdot 0.5^0 + 0 \cdot 0.5^1 + 1 \cdot 0.5^2 + 1 \cdot 0.5^3]\\
&amp;= 0.5[1 + 0 + 0.25 + 0.125] = 0.6875
\end{aligned}\]</span>
<p>Para la marca B: <span class="math inline">\(z_{B,t} = 0.5[0 + 1 \cdot 0.5^1 + 0 + 0] = 0.25\)</span></p>
<p>Para la marca C: <span class="math inline">\(z_{C,t} = 0\)</span></p>
<p>Si <span class="math inline">\(\gamma = 2\)</span>, entonces la marca A recibe un incremento de utilidad de <span class="math inline">\(2 \times 0.6875 = 1.375\)</span> debido a la lealtad acumulada.</p>
</div>
<div id="precios-de-referencia" class="section level4 hasAnchor" number="3.2.4.2">
<h4><span class="header-section-number">3.2.4.2</span> Precios de Referencia<a href="modelos-estructurales.html#precios-de-referencia" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Otro aspecto fundamental del comportamiento de compra con datos de panel es la formación de <strong>precios de referencia</strong> (reference prices). Los consumidores no evalúan los precios en términos absolutos, sino que los comparan con un precio de referencia interno formado a partir de precios observados en el pasado. Esta noción está bien fundamentada tanto en teoría económica (teoría de prospectos) como en evidencia empírica de marketing.</p>
<p><strong>Modelamiento de Precios de Referencia:</strong></p>
<p>La utilidad se especifica incorporando tanto el efecto del precio actual como de la desviación respecto al precio de referencia:</p>
<p><span class="math display" id="eq:utilrefprice">\[\begin{equation}
u_{nit} = \alpha_i + \beta_1 P_{nit} - \beta_2(P_{nit} - RP_{nit}) + \delta x_{nit} + \varepsilon_{nit}
\tag{3.15}
\end{equation}\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(P_{nit}\)</span> es el precio actual de la alternativa <span class="math inline">\(i\)</span> para el individuo <span class="math inline">\(n\)</span> en período <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(RP_{nit}\)</span> es el <strong>precio de referencia</strong> (no observable) de la alternativa <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\beta_1\)</span> captura el efecto del precio absoluto</li>
<li><span class="math inline">\(\beta_2\)</span> captura el efecto de pérdida/ganancia respecto al precio de referencia</li>
<li><span class="math inline">\(x_{nit}\)</span> son otras covariables</li>
</ul>
<p><strong>Interpretación de Coeficientes:</strong></p>
<ul>
<li><strong>Precio absoluto (<span class="math inline">\(\beta_1\)</span>):</strong> Se espera <span class="math inline">\(\beta_1 &lt; 0\)</span> - mayor precio reduce utilidad</li>
<li><strong>Desviación de precio de referencia (<span class="math inline">\(\beta_2\)</span>):</strong> Se espera <span class="math inline">\(\beta_2 &gt; 0\)</span>
<ul>
<li>Si <span class="math inline">\(P_{nit} &gt; RP_{nit}\)</span> (precio mayor que referencia): efecto negativo adicional - “pérdida percibida”</li>
<li>Si <span class="math inline">\(P_{nit} &lt; RP_{nit}\)</span> (precio menor que referencia): efecto positivo adicional - “ganancia percibida”</li>
</ul></li>
</ul>
<p>La especificación captura que los consumidores son <strong>más sensibles a desviaciones del precio de referencia</strong> que al nivel de precio absoluto, consistente con teoría de prospectos que postula mayor sensibilidad a pérdidas que a ganancias.</p>
<p><strong>Construcción del Precio de Referencia:</strong></p>
<p>Similar a la lealtad, el precio de referencia se construye como promedio ponderado exponencialmente de precios pasados:</p>
<p><span class="math display" id="eq:refprice">\[\begin{equation}
RP_{nit} = \lambda RP_{nit-1} + (1-\lambda) P_{nit-1}
\tag{3.16}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\lambda\)</span> es el parámetro de persistencia del precio de referencia.</p>
<p><strong>Especificación asimétrica:</strong></p>
<p>La teoría de prospectos sugiere que las pérdidas (precios mayores que referencia) pesan más que las ganancias (precios menores). Esto motiva especificaciones asimétricas:</p>
<p><span class="math display" id="eq:utilasym">\[\begin{equation}
u_{nit} = \alpha_i + \beta_1 P_{nit} - \beta_2^+ \max(P_{nit} - RP_{nit}, 0) - \beta_2^- \max(RP_{nit} - P_{nit}, 0) + \delta x_{nit} + \varepsilon_{nit}
\tag{3.17}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\beta_2^+\)</span> captura el efecto de precios superiores a la referencia (pérdida) y <span class="math inline">\(\beta_2^-\)</span> el efecto de precios inferiores (ganancia). Típicamente se encuentra <span class="math inline">\(\beta_2^+ &gt; \beta_2^-\)</span>, confirmando aversión a pérdidas.</p>
<p><strong>Ejemplo Numérico:</strong></p>
<p>Considérese un producto con la siguiente historia de precios: $10, $12, $9, $11, ?.
Con <span class="math inline">\(\lambda = 0.6\)</span>:</p>
<span class="math display">\[\begin{aligned}
RP_t &amp;= 0.6 \cdot RP_{t-1} + 0.4 \cdot P_{t-1}\\
RP_2 &amp;= 0.4 \cdot 10 = 4.0\\
RP_3 &amp;= 0.6 \cdot 4.0 + 0.4 \cdot 12 = 7.2\\
RP_4 &amp;= 0.6 \cdot 7.2 + 0.4 \cdot 9 = 7.92\\
RP_5 &amp;= 0.6 \cdot 7.92 + 0.4 \cdot 11 = 9.152
\end{aligned}\]</span>
<p>Si en el período 5 el precio es $13 y se tiene <span class="math inline">\(\beta_1 = -0.5\)</span> y <span class="math inline">\(\beta_2 = 0.8\)</span>:</p>
<p><span class="math display">\[u_5 = \alpha + (-0.5)(13) - 0.8(13 - 9.152) + ... = \alpha - 6.5 - 3.08 + ... \]</span></p>
<p>El precio $13 genera:</p>
<ul>
<li>Efecto directo: <span class="math inline">\(-0.5 \times 13 = -6.5\)</span></li>
<li>Efecto de pérdida percibida: <span class="math inline">\(-0.8 \times 3.848 = -3.08\)</span></li>
<li><strong>Efecto total:</strong> <span class="math inline">\(-9.58\)</span> (más negativo que solo el efecto directo)</li>
</ul>
</div>
<div id="combinación-de-persistencia-y-precios-de-referencia" class="section level4 hasAnchor" number="3.2.4.3">
<h4><span class="header-section-number">3.2.4.3</span> Combinación de Persistencia y Precios de Referencia<a href="modelos-estructurales.html#combinación-de-persistencia-y-precios-de-referencia" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En la práctica, ambos fenómenos suelen coexistir. Un modelo integrado especificaría:</p>
<p><span class="math display" id="eq:utilfull">\[\begin{equation}
u_{nit} = \alpha_i + \beta_1 P_{nit} - \beta_2(P_{nit} - RP_{nit}) + \gamma z_{nit} + \delta x_{nit} + \varepsilon_{nit}
\tag{3.18}
\end{equation}\]</span></p>
<p>donde tanto <span class="math inline">\(z_{nit}\)</span> como <span class="math inline">\(RP_{nit}\)</span> se construyen recursivamente usando los datos históricos del individuo:</p>
<span class="math display">\[\begin{aligned}
z_{nit} &amp;= \lambda_z z_{nit-1} + (1-\lambda_z) y_{nit-1}\\
RP_{nit} &amp;= \lambda_p RP_{nit-1} + (1-\lambda_p) P_{nit-1}
\end{aligned}\]</span>
</div>
</div>
<div id="apéndice" class="section level3 unnumbered hasAnchor">
<h3>Apéndice<a href="modelos-estructurales.html#apéndice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Derivación probabilidad de elección modelo logit</strong></p>
<p>Por definición</p>
<p><span class="math display">\[P_{nit} = Pr(\varepsilon_{njt}&lt;v_{nit} - v_{njt} + \varepsilon_{nit}), \forall j \neq i\]</span>
Fijando el valor de <span class="math inline">\(\varepsilon_{nit}\)</span>, la probabilidad anterior no es más que una multiplicación de funciones de distribución de variables aleatorias valor extremo. Por lo tanto, se puede condicionar en <span class="math inline">\(\varepsilon_{nit}\)</span> y luego integrar respecto a los valores que puede tomar. Para simplificar la notación, sea <span class="math inline">\(s=\varepsilon_{nit}\)</span>.</p>
<span class="math display">\[\begin{aligned}
P_{nit} &amp;= \int_{-\infty}^{\infty} \left(\prod_{j\neq i}    e^{-e^{-(s + v_{ni} - v_{nj})}}\right) e^{-s} e^{-e^{-s}}ds\\
&amp;= \int_{-\infty}^{\infty} \left(\prod_{j}   e^{-e^{-(s + v_{ni} - v_{nj})}}\right) e^{-s}ds\\
&amp;= \int_{-\infty}^{\infty} exp\left(\sum_{j}  e^{-(v_{ni} - v_{nj})}\right) e^{-s}ds
\end{aligned}\]</span>
<p>Para resolver la integral, se puede recurrir a un cambio de variables <span class="math inline">\(t = e^{−s}\)</span> y <span class="math inline">\(dt = e^{−s}ds\)</span>. Con esto:</p>
<span class="math display">\[\begin{aligned}
P_{nit} &amp;= \int_{\infty}^{0} -e^{t\sum_{j}  e^{-(v_{ni} - v_{nj})}} dt\\
&amp;= \frac{ e^{-(v_{ni} - v_{nj})}}{\sum_{j}  e^{-(v_{ni} - v_{nj})}}\mid^{\infty}_{0}\\
&amp;= \frac{e^{v_{ni}}}{\sum_j e^{v_{nj}}}
\end{aligned}\]</span>
</div>
</div>
<div id="probit" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Probit<a href="modelos-estructurales.html#probit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="definición" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Definición<a href="modelos-estructurales.html#definición" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Al introducir modelos de elección discreta, se postuló que los tomadores de decisiones disponían de una función de utilidad subyacente que se descomponía en una componente determinística y otra aleatoria. Más aún, se discutió que el modelo que describe la probabilidad de elegir cada una de las alternativas quedaba directamente determinado por la distribución que se asumiera para la componente aleatoria de la utilidad. Aunque una especificación de errores normales centrados en cero tiene una larga tradición en modelos econométricos, por simplicidad se optó por iniciar la discusión con modelos <em>logit</em> derivados de asumir que la componente aleatoria de la utilidad se distribuía valor extremo tipo I. En este capítulo se volverá al caso de componentes aleatorias normales que dan origen al modelo probit. Formalmente, un modelo <em>probit</em> resulta de los siguientes supuestos de comportamiento:</p>
<p><span class="math display" id="eq:compo">\[\begin{equation} 
  \begin{array}{cc}
  u_{ni} = v_{ni} + \varepsilon_{ni}, &amp;\varepsilon_n \sim N(0,\Sigma)
  \end{array}  
  \tag{3.19}
\end{equation}\]</span></p>
<p>La normalidad de los errores provee bastante flexibilidad para acomodar una amplia variedad de estructuras de las preferencias. Como se verá en la discusión que sigue, un modelo con errores normales permite acomodar factores sistemáticos no observables en la utilidad. Una de las pocas limitaciones de un modelo probit viene de la normalidad de dichos factores. Por ejemplo, si se quiere incorporar el efecto que tiene el precio en la utilidad como una componente aleatoria, entonces las colas de la distribución normal implicarán una probabilidad positiva de que algunos clientes aumenten la utilidad de una alternativa si aumenta el precio de esta. Formalmente, el supuesto de la normalidad de la componente aleatoria de la utilidad implica que su función de densidad viene dada por:</p>
<p><span class="math display" id="eq:density">\[\begin{equation} 
  \phi(\varepsilon_n) = \frac{1}{(2\pi)^{I/2}|\Sigma|^{1/2}}e^{-\frac{1}{2} \varepsilon&#39;_n \Sigma^{-1}\varepsilon_n} 
  \tag{3.20}
\end{equation}\]</span></p>
<p>Esta expresión no es más que la versión multivariada de la bien conocida densidad de la distribución <span class="math inline">\(N(0, \sigma^2)\)</span>. La matriz <span class="math inline">\(\Sigma\)</span> corresponde a la matriz varianza-covarianza de los errores. Por tratarse de una distribución normal, la matriz <span class="math inline">\(\Sigma\)</span> es simétrica y de dimensión <span class="math inline">\(I \times I\)</span>, donde <span class="math inline">\(I\)</span> es el número de alternativas disponibles para el tomador de decisión. Por ejemplo, si hay tres alternativas disponibles, la matriz <span class="math inline">\(\Sigma\)</span> tomaría la siguiente forma:</p>
<p><span class="math display" id="eq:matrix">\[\begin{equation} 
  \Sigma = \begin{bmatrix} \sigma_{11} &amp; \sigma_{12} &amp; \sigma_{13}\\
 \cdot &amp; \sigma_{22} &amp; \sigma_{23}\\
 \cdot &amp; \cdot &amp; \sigma_{33}
\end{bmatrix} 
  \tag{3.21}
\end{equation}\]</span></p>
<p>Los coeficientes en la diagonal dan cuenta de la variabilidad de la componente aleatoria de la utilidad. Así, por ejemplo, si <span class="math inline">\(\sigma_{ii}\)</span> tiene un valor alto indica que hay una fracción importante de la utilidad de la alternativa <span class="math inline">\(i\)</span> que no es capturada por el modelo de la componente sistemática. Los coeficientes fuera de la diagonal dan cuenta de la correlación de las componentes no observables de cada una de las alternativas. De este modo, si <span class="math inline">\(\sigma_{ij}\)</span> tiene un valor positivo alto indica que existe un elemento no observable importante que afecta simultáneamente las alternativas <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span>.</p>
<p>Como se vio en el desarrollo del modelo <em>logit</em>, una componente fundamental para estimar un modelo de elección discreta es la derivación de una expresión para la probabilidad de que cada agente elija cada alternativa en cada ocasión. Para el modelo probit, la probabilidad de que el individuo <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span> viene dada por:</p>
<p><span class="math display" id="eq:modprobit">\[\begin{equation} 
  \begin{aligned}
    P_{ni} &amp;= Pr (v_{ni} + \varepsilon_{ni} &gt; v_{nj} + \varepsilon_{nj}), \forall j \neq i \\
    &amp;= \int \mathbb{1}_{[v_{ni} + \varepsilon_{ni} &gt; v_{nj} + \varepsilon_{nj}]}\phi(\varepsilon_n)d\varepsilon_n, \forall j \neq i
  \end{aligned}  
  \tag{3.22}
\end{equation}\]</span></p>
<p>Intuitivamente, simplemente se calcula el volumen bajo la densidad <span class="math inline">\(\phi(\varepsilon_n)\)</span> en la región en que los errores son tales que la alternativa <span class="math inline">\(i\)</span> es aquella que reporta mayor utilidad al individuo <span class="math inline">\(n\)</span>. A diferencia del modelo logit, la integral sobre la densidad <span class="math inline">\(\phi(\cdot)\)</span> no tiene primitiva analítica y, por tanto, no se dispone de una fórmula cerrada para <span class="math inline">\(P_{ni}\)</span>. Una aproximación estándar es usar simulación Monte Carlo. Para cada individuo <span class="math inline">\(n\)</span> y alternativa <span class="math inline">\(i\)</span>, se genera un conjunto de <span class="math inline">\(R\)</span> vectores de errores <span class="math inline">\(\{\varepsilon_n^{(r)}\}_{r=1}^R\)</span> desde la distribución normal multivariada especificada. La probabilidad de elección se aproxima mediante:</p>
<p><span class="math display" id="eq:simprob">\[\begin{equation}
\hat{P}_{ni}(\theta) = \frac{1}{R}\sum_{r=1}^R \mathbb{1}\left[v_{ni}(x_{ni},\theta) + \varepsilon_{ni}^{(r)} &gt; v_{nj}(x_{nj},\theta) + \varepsilon_{nj}^{(r)}, \forall j \neq i\right]
\tag{3.23}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\mathbb{1}\{\cdot\}\)</span> es la función indicadora. La log-verosimilitud simulada se construye como <span class="math inline">\(\sum_n\sum_i y_{ni}\log\hat{P}_{ni}(\theta)\)</span> y se maximiza numéricamente con respecto a <span class="math inline">\(\theta\)</span>. A medida que <span class="math inline">\(R \to \infty\)</span>, el estimador de máxima verosimilitud simulada converge al estimador de máxima verosimilitud verdadero.</p>
</div>
<div id="patrones-de-substitución" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Patrones de substitución<a href="modelos-estructurales.html#patrones-de-substitución" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una de las grandes ventajas de un modelo <em>probit</em> es su flexibilidad para capturar una amplia variedad de patrones de comportamiento. En efecto, un modelo <em>probit</em> no impone restricciones en los patrones de sustitución más allá de la simetría propia de la distribución normal, lo que posibilita al analista explorar el esquema que mejor se ajusta a los datos. En este sentido, es útil compararlo con el modelo <em>logit</em> que, aunque provee una fórmula analítica cerrada para la probabilidad de cada elección, impone la propiedad de sustitución proporcional (o de independencia de alternativas irrelevantes). El modelo probit no tiene esta propiedad y, por tanto, el aumento de la probabilidad de elección de una alternativa puede tener impactos diferentes en las probabilidades de elección de las alternativas remanentes. Esto permitiría, por ejemplo, identificar pares de alternativas que son mejores sustitutos (complementos) más allá de las comunalidades que podrían existir en las componentes determinísticas de su utilidad.</p>
<p>A continuación se discutirá cómo el modelo probit puede ser usado para representar algunas situaciones de elección discreta.</p>
<div id="variación-aleatoria-en-preferencias" class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> Variación aleatoria en preferencias<a href="modelos-estructurales.html#variación-aleatoria-en-preferencias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Una de las componentes más importantes en el diseño de un plan comercial exitoso es la identificación de cómo las preferencias de los potenciales clientes se distribuyen en la población. Identificando estas variaciones, se pueden encontrar las propuestas de valor que resulten más atractivas para cada grupo de clientes. En un modelo probit, se puede asumir que los parámetros que definen la componente determinística son heterogéneos en la población sin perder los supuestos básicos que definen el modelo. Por simplicidad, supóngase que la componente determinística de la utilidad es lineal:</p>
<p><span class="math display" id="eq:cdeterminista">\[\begin{equation} 
  \begin{array}{cc}
    u_{ni} = \beta&#39;_{n} x_{ni} + \varepsilon_{ni}, &amp; \varepsilon_n \sim N(0,\Sigma)
  \end{array}  
  \tag{3.24}
\end{equation}\]</span></p>
<p>Nótese que, a diferencia de los modelos anteriores, ahora se ha asumido que cada tomador de decisión <span class="math inline">\(n\)</span> tiene su propio conjunto de parámetros <span class="math inline">\(\beta_n\)</span> que describen sus preferencias por las alternativas disponibles. Para completar el modelo se necesita especificar una distribución de <span class="math inline">\(\beta_n\)</span> en la población. Para mantener la estructura del modelo se asumirá normalidad: <span class="math inline">\(\beta_n \sim N(b, \sigma^2_\beta)\)</span>. Dado que la suma de dos variables aleatorias normales se distribuye normal, es fácil ver que el modelo es equivalente a:</p>
<p><span class="math display" id="eq:cdeterministaequi">\[\begin{equation} 
  \begin{array}{cc}
    u_{ni} = b&#39;_{n} x_{ni} + \eta_{ni}, &amp; \eta_n \sim (0,\hat{\Sigma})
  \end{array}  
  \tag{3.25}
\end{equation}\]</span></p>
<p>Las componentes de la matriz de varianza-covarianza resultante <span class="math inline">\(\hat{\Sigma}\)</span> pueden trazarse directamente a las componentes de la matriz <span class="math inline">\(\Sigma\)</span> original como lo indica el siguiente ejemplo:</p>
<p><strong>Ejemplo:</strong> Considérese un modelo de elección con dos alternativas y un modelo lineal con una única variable para describir la componente sistemática de la utilidad. En este caso, las utilidades por cada alternativa vienen dadas por:</p>
<span class="math display">\[\begin{aligned}
u_{n1} &amp;= \beta_n x_{n1} + \varepsilon_{n1}\\
u_{n2} &amp;= \beta_n x_{n2} + \varepsilon_{n2}
\end{aligned}\]</span>
<p>donde <span class="math inline">\(\varepsilon_{n1}\)</span> y <span class="math inline">\(\varepsilon_{n2}\)</span> son términos independientes e idénticamente distribuidos con varianza <span class="math inline">\(\sigma_\varepsilon\)</span>. Si se asume que el parámetro <span class="math inline">\(\beta_n\)</span> se distribuye normal con media <span class="math inline">\(b\)</span> y varianza <span class="math inline">\(\sigma_\beta\)</span>, entonces se puede reescribir las utilidades como:</p>
<span class="math display">\[\begin{aligned}
u_{n1} &amp;= b x_{n1} + \eta_{n1}\\
u_{n2} &amp;= b x_{n2} + \eta_{n2}
\end{aligned}\]</span>
<p>donde <span class="math inline">\(\eta_{n1}\)</span> y <span class="math inline">\(\eta_{n2}\)</span> están normalmente distribuidas. Cada una tiene esperanza cero: <span class="math inline">\(\mathbb{E}(\eta_{ni}) =\mathbb{E}(\beta_nx_{ni} + \varepsilon_{ni}) = 0\)</span>, varianza igual a <span class="math inline">\(\mathbb{V}ar(\eta_{ni}) = \mathbb{V}ar(\beta_n x_{ni} + \varepsilon_{ni}) = x^2_{ni}\sigma_\beta + \sigma_\varepsilon\)</span> y covarianzas <span class="math inline">\(\mathbb{C}ov(\eta_{n1}, \eta_{n2}) = x_{n1}x_{n2}\sigma_\beta\)</span>. Así, la matriz de covarianza viene dada por:</p>
<span class="math display">\[\begin{aligned}
\Sigma &amp;= \begin{bmatrix}x^2_{n1}\sigma_\beta + \sigma_\varepsilon &amp; x_{n1}x_{n2}\sigma_\beta\\
x_{n1}x_{n2}\sigma_\beta &amp; x^2_{n2}\sigma_\beta + \sigma_\varepsilon \end{bmatrix} \\
&amp;= \sigma_\beta \begin{bmatrix}x^2_{n1} &amp; x_{n1}x_{n2}\\
x_{n1}x_{n2} &amp; x^2_{n2} \end{bmatrix} + \sigma_{\varepsilon} \begin{bmatrix}1 &amp; 0\\
0 &amp; 1\end{bmatrix}
\end{aligned}\]</span>
<p>El siguiente paso es estimar. Recordando que el comportamiento no es afectado por transformaciones multiplicativas de la utilidad, es necesario escalar esta matriz. Lo recomendable es fijar <span class="math inline">\(\sigma_\varepsilon = 1\)</span>, obteniendo así:</p>
<p><span class="math display">\[Σ= \sigma_\beta \begin{bmatrix}x^2_{n1} &amp; x_{n1}x_{n2}\\
x_{n1}x_{n2} &amp; x^2_{n2} \end{bmatrix} + \begin{bmatrix}1 &amp; 0\\
0 &amp; 1\end{bmatrix}\]</span></p>
</div>
<div id="dependencia-del-tiempo" class="section level4 hasAnchor" number="3.3.2.2">
<h4><span class="header-section-number">3.3.2.2</span> Dependencia del tiempo<a href="modelos-estructurales.html#dependencia-del-tiempo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se ha discutido que bajo un modelo <em>probit</em> se pueden estudiar relaciones no observables entre las alternativas de elección. En las bases disponibles para la función comercial, las observaciones suelen estar indexadas temporalmente generando estructuras de panel que permiten estudiar aspectos interesantes de los agentes. A continuación se discute cómo usar un modelo <em>probit</em> para explorar no solo la relación entre las utilidades de alternativas, sino que también, el comportamiento de las utilidades de las alternativas en el tiempo.</p>
<p>Al igual que en la sección anterior, se busca encontrar patrones temporales en las componentes no observables de la utilidad, ya que las variaciones en la componente observable pueden ser fácilmente estudiadas incluyendo variables observables que describan la evolución temporal del sistema. Por ejemplo, si se cree que la utilidad de una de las alternativas es creciente en el tiempo, basta incluir el tiempo <span class="math inline">\(t\)</span> entre las variables independientes en la descripción de la utilidad de la alternativa. En general, se debería esperar que las utilidades estén correlacionadas tanto en el tiempo como entre las alternativas, ya que los factores que no son observados por el analista suelen ser persistentes en el tiempo. Eventualmente un modelo <em>probit</em> también podría ayudar a identificar shocks en que hay variaciones instantáneas (o de unos pocos períodos) en las utilidades de varias de las alternativas.</p>
<p>Supóngase que se observa un panel de <span class="math inline">\(N\)</span> clientes que deciden respecto de <span class="math inline">\(I\)</span> alternativas en <span class="math inline">\(T\)</span> períodos y que la utilidad del producto que el agente <span class="math inline">\(n\)</span> deriva sobre la alternativa <span class="math inline">\(i\)</span> en el período <span class="math inline">\(t\)</span> viene dada por:</p>
<p><span class="math display" id="eq:cdeterministaequi">\[\begin{equation} 
  \begin{array}{cc}
    u_{ni} = v_{nit} + \varepsilon_{nit},  &amp; [\varepsilon_{n11},...,\varepsilon_{nI1},\varepsilon_{n12}, ..., \varepsilon_{nI2},...,\varepsilon_{n1T},...,\varepsilon_{nIT}] \sim N(0,Σ)
  \end{array}  
  \tag{3.25}
\end{equation}\]</span></p>
<p>La matriz de covarianza tiene dimensión <span class="math inline">\(IT \times IT\)</span> (como se verá, no todas las componentes son identificables y se deberá imponer ciertas restricciones). Para paneles típicos, <span class="math inline">\(T\)</span> es grande y genera matrices de varianza-covarianza muy grandes. Por ejemplo, si se tienen datos semanales de compras de 5 marcas por un período de 2 años, se enfrentará una matriz de varianza (sin normalizar) con 5 × 104 = 520 filas y 520 columnas, lo que generaría no solo un modelo difícil de estimar numéricamente sino también difícil de interpretar. Así, para usar un modelo <em>probit</em> con dependencia en el tiempo, típicamente se agregará estructura al modelo. Por ejemplo, se puede restringir el análisis a grupos de períodos que podría ser el caso de las decisiones antes y después de una intervención en el sistema (e.g., antes y después del lanzamiento de una campaña publicitaria).</p>
<p><strong>Ejemplo:</strong> Supóngase un caso de elección binaria, el error está compuesto por una componente sistemática específica del tomador de decisión y otra que es variable en el tiempo.</p>
<p><span class="math display" id="eq:errorbinario">\[\begin{equation} 
  \varepsilon_{nt} = \eta_n + \mu_{nt}
  \tag{3.26}
\end{equation}\]</span></p>
<p>Si se asume que <span class="math inline">\(η_n\)</span> está distribuida <span class="math inline">\(N(0, σ)\)</span> y <span class="math inline">\(\mu_{nt}\)</span> en <span class="math inline">\(N(0, 1)\)</span>, entonces la varianza y covarianza son</p>
<p><span class="math display" id="eq:varbinaria">\[\begin{equation} 
  \mathbb{V}ar(\varepsilon_{nt}) =  \mathbb{V}ar(\eta_{n}+ \mu_{nt}) = \sigma + 1
    \tag{3.27}
  \end{equation}\]</span></p>
<p><span class="math display" id="eq:covbinaria">\[\begin{equation} 
  \mathbb{C}ov(\varepsilon_{nt},\varepsilon_{ns}) =  \mathbb{E}((\eta_{n}+ \mu_{nt}) (\eta_{n}+ \mu_{ns})) = \sigma
    \tag{3.28}
  \end{equation}\]</span></p>
<p>La matriz <span class="math inline">\(\Sigma\)</span>, por lo tanto, es</p>
<p><span class="math display" id="eq:matrizsum">\[\begin{equation} 
  Σ = \begin{bmatrix}\sigma +1 &amp; \sigma &amp; ... &amp; \sigma\\
\sigma &amp; \sigma+1 &amp; ... &amp; \sigma\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
\sigma &amp; \sigma &amp; \dots &amp; \sigma +1
\end{bmatrix}
    \tag{3.29}
  \end{equation}\]</span></p>
</div>
</div>
<div id="identificación" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Identificación<a href="modelos-estructurales.html#identificación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para estimar un modelo <em>probit</em>, junto con los parámetros de la componente sistemática de la utilidad se necesita estimar los coeficientes de la matriz <span class="math inline">\(\Sigma\)</span>. Por tratarse de una distribución normal, la matriz <span class="math inline">\(\Sigma\)</span> es simétrica y, por tanto, en principio se deben estimar <span class="math inline">\(\frac{I(I+1)}{2}\)</span> de sus componentes. Sin embargo, dicho problema no es identificable y se necesita imponer restricciones adicionales. La intuición detrás de esta falta de identificación resulta de asumir que las utilidades subyacentes que maximizan los individuos son monótonas y homotéticas. En otras palabras, se puede agregar un valor constante a las utilidades de cada una de las alternativas o escalarlas en cualquier proporción y la identidad de la alternativa de mayor utilidad no cambia. En general, si se tienen <span class="math inline">\(I\)</span> alternativas, solo se pueden identificar <span class="math inline">\(\frac{I(I+1)}{2} -1\)</span> parámetros. A continuación se discutirán dos enfoques para generar restricciones que hagan el problema identificable.</p>
<div id="normalización-de-las-funciones-de-utilidad" class="section level4 hasAnchor" number="3.3.3.1">
<h4><span class="header-section-number">3.3.3.1</span> Normalización de las funciones de utilidad<a href="modelos-estructurales.html#normalización-de-las-funciones-de-utilidad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Motivados en las propiedades de la función de utilidad, este enfoque consiste en imponer directamente restricciones de escala y locación. Este enfoque es completamente general y permite además garantizar identificación con un procedimiento estándar que puede incluso automatizarse. Formalmente el proceso consiste en imponer dos restricciones:</p>
<ol style="list-style-type: decimal">
<li><p>FIJAR LOCACIÓN: Como el valor absoluto de las utilidades es irrelevante, se puede fijar arbitrariamente el punto de referencia sobre el cual se interpretarán las utilidades. De esta forma, se tomará la utilidad de una de las alternativas como referencia y se redefinirán las utilidades como las diferencias con respecto a la alternativa de referencia.</p></li>
<li><p>FIJAR ESCALA: Como la escala de las utilidades es irrelevante, se puede fijarla asignando un valor arbitrario a cualquiera de las componentes de la matriz de varianza covarianza. Típicamente se impondrá que la primera componente de la diagonal tome el valor 1.</p></li>
</ol>
<p><strong>Ejemplo:</strong> Considérese la normalización de una matriz <span class="math inline">\(\Sigma\)</span> resultante de un problema de elección discreto de 4 alternativas.</p>
<p><span class="math display" id="eq:matrixcuatro">\[\begin{equation} 
  Σ = \begin{bmatrix} \sigma_{11} &amp; \sigma_{12} &amp; \sigma_{13} &amp; \sigma_{13}\\
 \cdot &amp; \sigma_{22} &amp; \sigma_{23} &amp; \sigma_{24}\\
 \cdot &amp; \cdot &amp; \sigma_{33} &amp; \sigma_{34}\\
 \cdot &amp; \cdot &amp; \cdot &amp; \sigma_{44}
\end{bmatrix} 
  \tag{3.30}
\end{equation}\]</span></p>
<p>El primer paso en la normalización es considerar diferencias de utilidades con respecto a una alternativa de referencia, la que por simplicidad se escogerá como la primera de la lista. Al fijar esta utilidad y tomar las diferencias, se ha reducido la dimensión del vector de errores, resultando en una matriz de varianza-covarianza <span class="math inline">\(\hat{Σ} = \{\hat{σ}_{ij}\}^3_{i,j=1}\)</span> cuyas componentes vienen dadas por:</p>
<span class="math display">\[\begin{aligned}
\hat{\sigma}_{22} &amp;= \sigma_{22} + \sigma_{11} - 2\sigma_{12}\\
\hat{\sigma}_{33} &amp;= \sigma_{33} + \sigma_{11} - 2\sigma_{13}\\
\hat{\sigma}_{44} &amp;= \sigma_{44} + \sigma_{11} - 2\sigma_{14}\\
\hat{\sigma}_{23} &amp;= \sigma_{23} + \sigma_{11} - \sigma_{12} - \sigma_{13}\\
\hat{\sigma}_{24} &amp;= \sigma_{24} + \sigma_{11} - \sigma_{12} - \sigma_{14}\\
\hat{\sigma}_{34} &amp;= \sigma_{34} + \sigma_{11} - \sigma_{13} - \sigma_{14}
\end{aligned}\]</span>
<p>El segundo paso en la normalización es fijar en 1 (o cualquier otro real positivo) una de las componentes de la diagonal de la matriz de varianza covarianza para precisar la escala de la función de utilidad. Por simplicidad se escoge la primera componente de la diagonal. Para hacerla 1 basta con dividir toda la matriz por dicha componente, resultando en una matriz de varianza-covarianza <span class="math inline">\(\hat{Σ} = \{\hat{σ}_{ij}\}^3_{i,j=1}\)</span> cuyas componentes vienen dadas por:</p>
<span class="math display">\[\begin{aligned}
\hat{\sigma}_{33} &amp;= \frac{\sigma_{33} + \sigma_{11} - 2\sigma_{13}}{\sigma_{22} + \sigma_{11} - 2\sigma_{12}}\\
\hat{\sigma}_{44} &amp;= \frac{\sigma_{44} + \sigma_{11} - 2\sigma_{14}}{\sigma_{22} + \sigma_{11} - 2\sigma_{12}}\\
\hat{\sigma}_{23} &amp;= \frac{\sigma_{23} + \sigma_{11} - \sigma_{12} - \sigma_{13}}{\sigma_{22} + \sigma_{11} - 2\sigma_{12}}\\
\hat{\sigma}_{24} &amp;= \frac{\sigma_{24} + \sigma_{11} - \sigma_{12} - \sigma_{14}}{\sigma_{22} + \sigma_{11} - 2\sigma_{12}}\\
\hat{\sigma}_{34} &amp;= \frac{\sigma_{34} + \sigma_{11} - \sigma_{13} - \sigma_{14}}{\sigma_{22} + \sigma_{11} - 2\sigma_{12}}
\end{aligned}\]</span>
<p>La matriz resultante <span class="math inline">\(\hat{Σ}\)</span> es identificable. En ella es importante trazar sus componentes originales de la matriz sigma porque ayudan a darle interpretación a los resultados obtenidos en la estimación.</p>
</div>
<div id="incorporación-de-restricciones-estructurales" class="section level4 hasAnchor" number="3.3.3.2">
<h4><span class="header-section-number">3.3.3.2</span> Incorporación de restricciones estructurales<a href="modelos-estructurales.html#incorporación-de-restricciones-estructurales" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Aunque completamente general, la normalización descrita en la sección anterior, muchas veces puede ser algo inconveniente en cuanto los parámetros estimados no tienen interpretación
directa. Un enfoque que permite interpretar directamente los parámetros se obtiene al imponer estructura sobre la matriz de varianza-covarianza a partir de supuestos de comportamiento. Por ejemplo, se puede imponer que las componentes aleatorias de algunos pares de alternativas no están correlacionadas o que algún grupo de alternativas tiene la misma variabilidad de la componente no observable. El cuadro 4.1 ejemplifica algunas de las estructuras de varianza-covarianza comúnmente usadas en la literatura.</p>
<p>Otros modelos usados en la literatura y que están implementados en aplicaciones comerciales incluyen estructuras de bandas, Huynh-Feldt, autoregresivo heterogéneo y simetría compuesta. Como en otros aspectos de la modelación, la elección de la estructura a elegir para la matriz de
varianza-covarianza dependerá de las hipótesis de comportamiento que se tengan a la mano y la dificultad numérica de estimar el modelo resultante.</p>
</div>
</div>
</div>
<div id="nested-logit" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Nested Logit<a href="modelos-estructurales.html#nested-logit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introducción-2" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Introducción<a href="modelos-estructurales.html#introducción-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como se ha discutido previamente, una de las limitaciones fundamentales del modelo logit estándar es la propiedad de independencia de alternativas irrelevantes (IIA), que implica patrones de sustitución proporcionales entre todas las alternativas. Esta restricción puede resultar poco realista en muchas situaciones prácticas de marketing donde algunas alternativas son sustitutos más cercanos entre sí que con otras. El modelo <strong>Nested Logit</strong> (o Logit Anidado) surge como una extensión del modelo logit estándar que permite relajar parcialmente la restricción de IIA al permitir que las alternativas se agrupen en conjuntos (o “nidos”) donde la correlación entre alternativas dentro del mismo nido puede diferir de la correlación entre alternativas de nidos diferentes.</p>
<p>La idea fundamental del nested logit es reconocer que en muchos problemas de elección existe una estructura jerárquica natural. Los tomadores de decisión primero eligen entre categorías generales de alternativas (los nidos) y luego, dentro de la categoría seleccionada, eligen una alternativa específica. Esta estructura refleja de manera más realista muchos procesos de decisión en marketing.</p>
<p>Por ejemplo, se tiene el problema de elección de medio de transporte en una ciudad que ofrece las siguientes alternativas: auto particular, auto compartido (carpool), bus y tren. Intuitivamente, se esperaría que auto particular y auto compartido sean sustitutos más cercanos entre sí (ambos involucran viajar en auto) que cualquiera de ellos con respecto al bus o tren. Del mismo modo, bus y tren (ambos transporte público) serían sustitutos más cercanos entre sí. Un modelo logit estándar impondría que un incremento en el costo del bus afecta igualmente la probabilidad de elegir auto particular, auto compartido y tren, lo cual parece poco razonable. El nested logit permite capturar que el incremento en el costo del bus afectará más la probabilidad de elegir tren (mismo nido de transporte público) que la de elegir auto particular.</p>
</div>
<div id="estructura-del-modelo" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Estructura del Modelo<a href="modelos-estructurales.html#estructura-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="partición-en-nidos" class="section level4 hasAnchor" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> Partición en Nidos<a href="modelos-estructurales.html#partición-en-nidos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El modelo nested logit requiere una partición del conjunto de <span class="math inline">\(J\)</span> alternativas en <span class="math inline">\(K\)</span> subconjuntos exhaustivos y mutuamente excluyentes llamados <strong>nidos</strong>. Sea <span class="math inline">\(B_k\)</span> el conjunto de alternativas en el nido <span class="math inline">\(k\)</span>, donde <span class="math inline">\(k = 1, 2, ..., K\)</span>. La partición debe satisfacer:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\bigcup_{k=1}^K B_k = \{1, 2, ..., J\}\)</span> (exhaustividad)</li>
<li><span class="math inline">\(B_k \cap B_m = \emptyset\)</span> para <span class="math inline">\(k \neq m\)</span> (exclusividad mutua)</li>
</ol>
<p>Es importante destacar que la definición de los nidos debe basarse en consideraciones teóricas sobre qué alternativas son sustitutos más cercanos, no en criterios puramente estadísticos. La teoría económica, el conocimiento del mercado y la intuición sobre el comportamiento del consumidor deben guiar esta partición.</p>
</div>
<div id="especificación-de-la-utilidad" class="section level4 hasAnchor" number="3.4.2.2">
<h4><span class="header-section-number">3.4.2.2</span> Especificación de la Utilidad<a href="modelos-estructurales.html#especificación-de-la-utilidad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En el modelo nested logit, la utilidad que el individuo <span class="math inline">\(n\)</span> deriva de la alternativa <span class="math inline">\(i\)</span> en el nido <span class="math inline">\(B_k\)</span> se especifica como:</p>
<p><span class="math display" id="eq:nestedutil">\[\begin{equation}
u_{ni} = v_{ni} + \varepsilon_{ni}
\tag{3.31}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(v_{ni}\)</span> es la componente sistemática (observable) de la utilidad y <span class="math inline">\(\varepsilon_{ni}\)</span> es la componente aleatoria.</p>
<p>La característica distintiva del nested logit es la estructura de correlación de los errores. A diferencia del logit estándar donde todos los <span class="math inline">\(\varepsilon_{ni}\)</span> son independientes, en el nested logit se permite que los errores de alternativas dentro del mismo nido estén correlacionados, mientras que los errores entre alternativas de diferentes nidos permanecen independientes.</p>
<p>Formalmente, se asume que el vector de errores <span class="math inline">\(\varepsilon_n = (\varepsilon_{n1}, ..., \varepsilon_{nJ})\)</span> tiene una distribución de valor extremo con función de distribución acumulada:</p>
<p><span class="math display" id="eq:gevdist">\[\begin{equation}
F(\varepsilon_{n1}, ..., \varepsilon_{nJ}) = \exp\left[-\sum_{k=1}^K \left(\sum_{i \in B_k} e^{-\varepsilon_{ni}/\lambda_k}\right)^{\lambda_k}\right]
\tag{3.32}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\lambda_k\)</span> es un parámetro que gobierna el grado de correlación entre alternativas en el nido <span class="math inline">\(k\)</span>, con <span class="math inline">\(0 &lt; \lambda_k \leq 1\)</span>:</p>
<ul>
<li><strong><span class="math inline">\(\lambda_k = 1\)</span>:</strong> Las alternativas en el nido <span class="math inline">\(k\)</span> no están correlacionadas (caso del logit estándar)</li>
<li><strong><span class="math inline">\(\lambda_k &lt; 1\)</span>:</strong> Las alternativas en el nido <span class="math inline">\(k\)</span> están positivamente correlacionadas; cuanto menor sea <span class="math inline">\(\lambda_k\)</span>, mayor es la correlación</li>
<li><strong><span class="math inline">\(\lambda_k \to 0\)</span>:</strong> Correlación perfecta entre alternativas del nido <span class="math inline">\(k\)</span></li>
</ul>
<p>La correlación entre dos alternativas <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span> en el mismo nido <span class="math inline">\(k\)</span> viene dada por:</p>
<p><span class="math display" id="eq:corrwithin">\[\begin{equation}
\text{Corr}(\varepsilon_{ni}, \varepsilon_{nj}) = 1 - \lambda_k^2, \quad \text{para } i, j \in B_k
\tag{3.33}
\end{equation}\]</span></p>
<p>Mientras que alternativas en nidos diferentes tienen correlación cero:</p>
<p><span class="math display" id="eq:corrbetween">\[\begin{equation}
\text{Corr}(\varepsilon_{ni}, \varepsilon_{nj}) = 0, \quad \text{para } i \in B_k, j \in B_m, k \neq m
\tag{3.34}
\end{equation}\]</span></p>
</div>
</div>
<div id="probabilidades-de-elección" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Probabilidades de Elección<a href="modelos-estructurales.html#probabilidades-de-elección" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una de las ventajas computacionales del modelo nested logit es que, a pesar de permitir correlación entre errores, aún se pueden derivar fórmulas cerradas para las probabilidades de elección.</p>
<div id="estructura-jerárquica-de-decisión" class="section level4 hasAnchor" number="3.4.3.1">
<h4><span class="header-section-number">3.4.3.1</span> Estructura Jerárquica de Decisión<a href="modelos-estructurales.html#estructura-jerárquica-de-decisión" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El nested logit puede interpretarse como un proceso de decisión secuencial en dos etapas:</p>
<ol style="list-style-type: decimal">
<li><strong>Etapa 1 (elección de nido):</strong> El individuo elige qué nido <span class="math inline">\(B_k\)</span> le proporciona mayor utilidad esperada</li>
<li><strong>Etapa 2 (elección dentro del nido):</strong> Dado el nido seleccionado, el individuo elige la alternativa específica dentro de ese nido</li>
</ol>
</div>
<div id="probabilidad-condicional-etapa-2" class="section level4 hasAnchor" number="3.4.3.2">
<h4><span class="header-section-number">3.4.3.2</span> Probabilidad Condicional (Etapa 2)<a href="modelos-estructurales.html#probabilidad-condicional-etapa-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La probabilidad de que el individuo <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span> dado que ha elegido el nido <span class="math inline">\(B_k\)</span> viene dada por:</p>
<p><span class="math display" id="eq:condprob">\[\begin{equation}
P_{ni|B_k} = \frac{\exp(v_{ni}/\lambda_k)}{\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)}
\tag{3.35}
\end{equation}\]</span></p>
<p>Esta expresión tiene la forma de un modelo logit estándar pero con las utilidades escaladas por <span class="math inline">\(\lambda_k\)</span>.</p>
</div>
<div id="valor-inclusivo-inclusive-value" class="section level4 hasAnchor" number="3.4.3.3">
<h4><span class="header-section-number">3.4.3.3</span> Valor Inclusivo (Inclusive Value)<a href="modelos-estructurales.html#valor-inclusivo-inclusive-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Un concepto fundamental en el nested logit es el <strong>valor inclusivo</strong> (o <strong>log-suma</strong>) del nido <span class="math inline">\(B_k\)</span>, definido como:</p>
<p><span class="math display" id="eq:inclusivevalue">\[\begin{equation}
IV_k = \ln\left(\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right)
\tag{3.36}
\end{equation}\]</span></p>
<p>El valor inclusivo <span class="math inline">\(IV_k\)</span> representa la utilidad esperada (antes de conocer los shocks aleatorios <span class="math inline">\(\varepsilon_{nj}\)</span>) que el individuo obtiene del nido <span class="math inline">\(k\)</span>. Es una medida del atractivo agregado de todas las alternativas en el nido, ajustada por el grado de correlación entre ellas.</p>
<p><strong>Interpretación Económica:</strong> El valor inclusivo captura el “valor de la opción” que proporciona tener múltiples alternativas similares disponibles. Un valor inclusivo alto indica que el nido contiene alternativas atractivas para el individuo.</p>
</div>
<div id="probabilidad-marginal-de-elegir-el-nido-etapa-1" class="section level4 hasAnchor" number="3.4.3.4">
<h4><span class="header-section-number">3.4.3.4</span> Probabilidad Marginal de Elegir el Nido (Etapa 1)<a href="modelos-estructurales.html#probabilidad-marginal-de-elegir-el-nido-etapa-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La probabilidad de elegir el nido <span class="math inline">\(B_k\)</span> viene dada por:</p>
<p><span class="math display" id="eq:nestprob">\[\begin{equation}
P_{nB_k} = \frac{\exp(\lambda_k \cdot IV_k)}{\sum_{m=1}^K \exp(\lambda_m \cdot IV_m)}
\tag{3.37}
\end{equation}\]</span></p>
<p>Esta probabilidad tiene también forma logit, donde la “utilidad” del nido es el valor inclusivo escalado por <span class="math inline">\(\lambda_k\)</span>.</p>
</div>
<div id="probabilidad-no-condicional-probabilidad-total" class="section level4 hasAnchor" number="3.4.3.5">
<h4><span class="header-section-number">3.4.3.5</span> Probabilidad No Condicional (Probabilidad Total)<a href="modelos-estructurales.html#probabilidad-no-condicional-probabilidad-total" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finalmente, la probabilidad de que el individuo <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span> en el nido <span class="math inline">\(B_k\)</span> se obtiene multiplicando las probabilidades de las dos etapas:</p>
<p><span class="math display" id="eq:totalprob">\[\begin{equation}
P_{ni} = P_{ni|B_k} \cdot P_{nB_k} = \frac{\exp(v_{ni}/\lambda_k)}{\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)} \cdot \frac{\exp(\lambda_k \cdot IV_k)}{\sum_{m=1}^K \exp(\lambda_m \cdot IV_m)}
\tag{3.38}
\end{equation}\]</span></p>
<p>Para reescribir esta expresión de forma más compacta, se procede de la siguiente manera. Recordando que <span class="math inline">\(IV_k = \ln\left[\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right]\)</span>, se tiene que:</p>
<p><span class="math display">\[\exp(\lambda_k \cdot IV_k) = \exp\left(\lambda_k \cdot \ln\left[\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right]\right) = \left[\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right]^{\lambda_k}\]</span></p>
<p>Sustituyendo esta expresión en el numerador de la probabilidad total:</p>
<span class="math display">\[\begin{aligned}
P_{ni} &amp;= \frac{\exp(v_{ni}/\lambda_k)}{\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)} \cdot \frac{\left[\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right]^{\lambda_k}}{\sum_{m=1}^K \left[\sum_{j \in B_m} \exp(v_{nj}/\lambda_m)\right]^{\lambda_m}}\\
&amp;= \frac{\exp(v_{ni}/\lambda_k) \cdot \left[\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right]^{\lambda_k}}{\left[\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right] \cdot \sum_{m=1}^K \left[\sum_{j \in B_m} \exp(v_{nj}/\lambda_m)\right]^{\lambda_m}}\\
&amp;= \frac{\exp(v_{ni}/\lambda_k) \cdot \left[\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)\right]^{\lambda_k - 1}}{\sum_{m=1}^K \left[\sum_{j \in B_m} \exp(v_{nj}/\lambda_m)\right]^{\lambda_m}}
\end{aligned}\]</span>
<p>Esto conduce a la forma compacta:</p>
<p><span class="math display" id="eq:totalprobcompact">\[\begin{equation}
P_{ni} = \frac{\exp(v_{ni}/\lambda_k) \cdot [\sum_{j \in B_k} \exp(v_{nj}/\lambda_k)]^{\lambda_k - 1}}{\sum_{m=1}^K [\sum_{j \in B_m} \exp(v_{nj}/\lambda_m)]^{\lambda_m}}
\tag{3.39}
\end{equation}\]</span></p>
</div>
</div>
<div id="propiedades-y-patrones-de-sustitución" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Propiedades y Patrones de Sustitución<a href="modelos-estructurales.html#propiedades-y-patrones-de-sustitución" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="relajación-parcial-de-iia" class="section level4 hasAnchor" number="3.4.4.1">
<h4><span class="header-section-number">3.4.4.1</span> Relajación Parcial de IIA<a href="modelos-estructurales.html#relajación-parcial-de-iia" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Una propiedad importante del nested logit es que la restricción de IIA se mantiene <strong>dentro de cada nido</strong> pero no <strong>entre nidos</strong>. Específicamente:</p>
<p><strong>Dentro del mismo nido:</strong> Para dos alternativas <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span> en el mismo nido <span class="math inline">\(B_k\)</span>:</p>
<p><span class="math display" id="eq:ratiowithin">\[\begin{equation}
\frac{P_{ni}}{P_{nj}} = \frac{\exp(v_{ni}/\lambda_k)}{\exp(v_{nj}/\lambda_k)} = \exp\left(\frac{v_{ni} - v_{nj}}{\lambda_k}\right)
\tag{3.40}
\end{equation}\]</span></p>
<p>Este ratio es independiente de otras alternativas, manteniendo IIA dentro del nido.</p>
<p><strong>Entre diferentes nidos:</strong> Para alternativas en nidos diferentes, el ratio de probabilidades sí depende de las características de otras alternativas a través de los valores inclusivos, permitiendo patrones de sustitución más realistas.</p>
</div>
<div id="elasticidades-de-sustitución" class="section level4 hasAnchor" number="3.4.4.2">
<h4><span class="header-section-number">3.4.4.2</span> Elasticidades de Sustitución<a href="modelos-estructurales.html#elasticidades-de-sustitución" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Las elasticidades propias y cruzadas en un modelo nested logit revelan cómo los patrones de sustitución difieren entre alternativas del mismo nido versus alternativas de nidos diferentes.</p>
<p><strong>Elasticidad propia:</strong> La elasticidad de <span class="math inline">\(P_{ni}\)</span> respecto a un atributo <span class="math inline">\(x_{ni}\)</span> de la misma alternativa es:</p>
<p><span class="math display" id="eq:elastown">\[\begin{equation}
\eta_{ii} = \frac{\partial P_{ni}}{\partial x_{ni}} \cdot \frac{x_{ni}}{P_{ni}} = \frac{\beta}{\lambda_k} x_{ni} \left(1 - P_{ni} - \lambda_k P_{ni|B_k}(1 - P_{ni|B_k})\right)
\tag{3.41}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\beta\)</span> es el coeficiente asociado a <span class="math inline">\(x_{ni}\)</span> en <span class="math inline">\(v_{ni}\)</span>.</p>
<p><strong>Elasticidad cruzada dentro del nido:</strong> Para alternativas <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span> en el mismo nido <span class="math inline">\(B_k\)</span>:</p>
<p><span class="math display" id="eq:elastwithin">\[\begin{equation}
\eta_{ij} = \frac{\partial P_{ni}}{\partial x_{nj}} \cdot \frac{x_{nj}}{P_{ni}} = \frac{\beta}{\lambda_k} x_{nj} P_{nj|B_k}(1 + \lambda_k(1 - P_{nj|B_k}))
\tag{3.42}
\end{equation}\]</span></p>
<p><strong>Elasticidad cruzada entre nidos:</strong> Para alternativas <span class="math inline">\(i \in B_k\)</span> y <span class="math inline">\(j \in B_m\)</span> con <span class="math inline">\(k \neq m\)</span>:</p>
<p><span class="math display" id="eq:elastbetween">\[\begin{equation}
\eta_{ij} = -\beta x_{nj} P_{nj}
\tag{3.43}
\end{equation}\]</span></p>
<p>Nótese que <span class="math inline">\(\eta_{ij}\)</span> (dentro del nido) depende de <span class="math inline">\(\lambda_k\)</span> y es típicamente mayor en magnitud que la elasticidad cruzada entre nidos, reflejando que alternativas dentro del mismo nido son mejores sustitutos.</p>
</div>
</div>
<div id="ejemplo" class="section level3 hasAnchor" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Ejemplo<a href="modelos-estructurales.html#ejemplo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En una situación de elección de tipo de vivienda en una ciudad hay cuatro alternativas: departamento pequeño (DP), departamento grande (DG), casa pequeña (CP) y casa grande (CG).</p>
<p><strong>Estructura de Nidos:</strong> Se propone una estructura con dos nidos:</p>
<ul>
<li>Nido 1 (Departamentos): <span class="math inline">\(B_1 = \{DP, DG\}\)</span></li>
<li>Nido 2 (Casas): <span class="math inline">\(B_2 = \{CP, CG\}\)</span></li>
</ul>
<p><strong>Especificación de Utilidad:</strong></p>
<span class="math display">\[\begin{aligned}
v_{n,DP} &amp;= \alpha_{DP} + \beta_1 \cdot precio_{DP} + \beta_2 \cdot distancia_{DP}\\
v_{n,DG} &amp;= \alpha_{DG} + \beta_1 \cdot precio_{DG} + \beta_2 \cdot distancia_{DG}\\
v_{n,CP} &amp;= \alpha_{CP} + \beta_1 \cdot precio_{CP} + \beta_2 \cdot distancia_{CP}\\
v_{n,CG} &amp;= \alpha_{CG} + \beta_1 \cdot precio_{CG} + \beta_2 \cdot distancia_{CG}
\end{aligned}\]</span>
<p>donde <span class="math inline">\(\alpha_i\)</span> son constantes alternativa-específicas, <span class="math inline">\(\beta_1 &lt; 0\)</span> captura el efecto del precio y <span class="math inline">\(\beta_2 &lt; 0\)</span> el efecto de la distancia al centro.</p>
<p><strong>Resultados Hipotéticos:</strong></p>
<p>Supóngase que la estimación arroja <span class="math inline">\(\lambda_1 = 0.6\)</span> y <span class="math inline">\(\lambda_2 = 0.7\)</span>. Esto implica:</p>
<ul>
<li><strong>Correlación en Nido 1 (Departamentos):</strong> <span class="math inline">\(1 - (0.6)^2 = 0.64\)</span></li>
<li><strong>Correlación en Nido 2 (Casas):</strong> <span class="math inline">\(1 - (0.7)^2 = 0.51\)</span></li>
</ul>
<p>Los departamentos presentan mayor correlación en sus componentes no observables que las casas, sugiriendo que hay factores no modelados (quizás preferencias por estilo de vida urbano, servicios comunes en edificios, etc.) que afectan similarmente la atractiva de ambos tipos de departamentos.</p>
<p><strong>Implicaciones para Sustitución:</strong></p>
<p>Si el precio del departamento grande aumenta, este incremento afectará más la probabilidad de elegir el departamento pequeño (mismo nido) que la probabilidad de elegir cualquiera de las casas. Formalmente, la elasticidad cruzada <span class="math inline">\(\eta_{DP,DG}\)</span> será mayor en magnitud que <span class="math inline">\(\eta_{DP,CP}\)</span> o <span class="math inline">\(\eta_{DP,CG}\)</span>.</p>
</div>
<div id="estimación-2" class="section level3 hasAnchor" number="3.4.6">
<h3><span class="header-section-number">3.4.6</span> Estimación<a href="modelos-estructurales.html#estimación-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La estimación del modelo nested logit se realiza mediante <strong>máxima verosimilitud</strong>. Dada una muestra de <span class="math inline">\(N\)</span> individuos donde cada individuo <span class="math inline">\(n\)</span> elige una alternativa <span class="math inline">\(i_n\)</span> de su conjunto de elección, la función de log-verosimilitud viene dada por:</p>
<p><span class="math display" id="eq:nestedll">\[\begin{equation}
LL(\theta, \lambda) = \sum_{n=1}^N \ln P_{ni_n}(\theta, \lambda)
\tag{3.44}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\theta\)</span> representa todos los parámetros de las utilidades sistemáticas y <span class="math inline">\(\lambda = (\lambda_1, ..., \lambda_K)\)</span> son los parámetros de disimilitud de cada nido.</p>
<p><strong>Procedimiento de Estimación:</strong></p>
<ol style="list-style-type: decimal">
<li>Especificar la partición en nidos <span class="math inline">\(\{B_1, ..., B_K\}\)</span></li>
<li>Especificar las funciones de utilidad <span class="math inline">\(v_{ni}\)</span> para cada alternativa</li>
<li>Calcular valores inclusivos <span class="math inline">\(IV_k\)</span> para cada nido</li>
<li>Calcular probabilidades <span class="math inline">\(P_{ni}\)</span> usando la ecuación <a href="modelos-estructurales.html#eq:totalprob">(3.38)</a></li>
<li>Maximizar la log-verosimilitud <a href="modelos-estructurales.html#eq:nestedll">(3.44)</a> con restricciones <span class="math inline">\(0 &lt; \lambda_k \leq 1\)</span></li>
</ol>
<p><strong>Test de Especificación:</strong></p>
<p>Un test natural es evaluar si <span class="math inline">\(\lambda_k = 1\)</span> para todos los nidos, lo que equivaldría al modelo logit estándar. Se puede usar un <strong>test de razón de verosimilitud</strong> comparando:</p>
<ul>
<li>Modelo restringido: Logit estándar (todos los <span class="math inline">\(\lambda_k = 1\)</span>)</li>
<li>Modelo no restringido: Nested logit con <span class="math inline">\(\lambda_k\)</span> estimados</li>
</ul>
<p>El estadístico <span class="math inline">\(LR = 2(LL_{nested} - LL_{logit})\)</span> se distribuye asintóticamente como <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(K\)</span> grados de libertad bajo la hipótesis nula de que el logit estándar es adecuado.</p>
</div>
<div id="extensiones-nested-logit-con-múltiples-niveles" class="section level3 hasAnchor" number="3.4.7">
<h3><span class="header-section-number">3.4.7</span> Extensiones: Nested Logit con Múltiples Niveles<a href="modelos-estructurales.html#extensiones-nested-logit-con-múltiples-niveles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo nested logit puede extenderse a <strong>estructuras jerárquicas de múltiples niveles</strong>, donde los nidos pueden a su vez contener sub-nidos. Por ejemplo, en el contexto de elección de vehículos, se podría tener:</p>
<ul>
<li><strong>Nivel 1:</strong> Tipo de combustión (gasolina vs. eléctrico)</li>
<li><strong>Nivel 2:</strong> Tamaño del vehículo (pequeño, mediano, grande)</li>
<li><strong>Nivel 3:</strong> Marca específica</li>
</ul>
<p>En este caso, la decisión se modela como una secuencia de elecciones desde el nivel más alto (combustión) hasta el más específico (marca), con parámetros de disimilitud en cada nivel capturando la correlación entre alternativas dentro de cada sub-nido.</p>
<p>La probabilidad de elección en un nested logit de tres niveles sigue una estructura análoga:</p>
<p><span class="math display" id="eq:threelevel">\[\begin{equation}
P_{ni} = P_{ni|nido_3} \cdot P_{nido_3|nido_2} \cdot P_{nido_2}
\tag{3.45}
\end{equation}\]</span></p>
<p>donde cada probabilidad condicional tiene forma logit con su respectivo parámetro de disimilitud.</p>
</div>
</div>
<div id="mixed-logit" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Mixed Logit<a href="modelos-estructurales.html#mixed-logit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introducción-y-motivación" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Introducción y Motivación<a href="modelos-estructurales.html#introducción-y-motivación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como se ha discutido anteriormente, el modelo logit estándar, aunque computacionalmente conveniente gracias a su forma cerrada, presenta limitaciones importantes que pueden restringir su aplicabilidad en contextos reales de marketing. El modelo <strong>Mixed Logit</strong> (también conocido como <strong>Random Parameters Logit</strong> o <strong>Error Components Logit</strong>) surgió como una generalización flexible del modelo logit estándar que permite superar las limitaciones de <em>Logit</em>. La idea fundamental es permitir que los parámetros de la función de utilidad varíen aleatoriamente en la población, capturando así heterogeneidad no observable en las preferencias.</p>
<p><strong>Intuición del Modelo:</strong></p>
<p>Supóngase que se está modelando la elección de medio de transporte (auto, bus, tren) y se sabe que la sensibilidad al tiempo de viaje varía sustancialmente entre individuos. Mientras que el logit estándar asumiría un único coeficiente de tiempo de viaje para toda la población, el mixed logit permite que este coeficiente siga una distribución en la población (por ejemplo, normal con cierta media y varianza), reflejando que algunos individuos son muy sensibles al tiempo mientras otros lo son menos.</p>
</div>
<div id="especificación-del-modelo" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Especificación del Modelo<a href="modelos-estructurales.html#especificación-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="función-de-utilidad-y-probabilidad-de-elección" class="section level4 hasAnchor" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Función de Utilidad y Probabilidad de Elección<a href="modelos-estructurales.html#función-de-utilidad-y-probabilidad-de-elección" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En un modelo mixed logit, la utilidad que el individuo <span class="math inline">\(n\)</span> deriva de la alternativa <span class="math inline">\(i\)</span> en la ocasión de elección <span class="math inline">\(t\)</span> viene dada por:</p>
<p><span class="math display" id="eq:mixedutil">\[\begin{equation}
u_{nit} = \beta&#39;_n x_{nit} + \varepsilon_{nit}
\tag{3.46}
\end{equation}\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(x_{nit}\)</span> es un vector de atributos observables de la alternativa <span class="math inline">\(i\)</span> para el individuo <span class="math inline">\(n\)</span> en el período <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\beta_n\)</span> es un vector de coeficientes <strong>aleatorios</strong> que varía entre individuos</li>
<li><span class="math inline">\(\varepsilon_{nit}\)</span> es un término de error i.i.d. valor extremo tipo I (como en el logit estándar)</li>
</ul>
<p>La característica clave es que <span class="math inline">\(\beta_n\)</span> no es un parámetro fijo, sino una <strong>variable aleatoria</strong> que sigue una distribución de probabilidad <span class="math inline">\(f(\beta | \theta)\)</span>, donde <span class="math inline">\(\theta\)</span> son los parámetros que describen esta distribución (típicamente media y varianza/covarianza).</p>
<p><strong>Especificación común:</strong> Se suele asumir que <span class="math inline">\(\beta_n \sim N(b, \Sigma_\beta)\)</span>, donde <span class="math inline">\(b\)</span> es el vector de medias poblacionales y <span class="math inline">\(\Sigma_\beta\)</span> es la matriz de varianzas-covarianzas.</p>
<p>Condicional en <span class="math inline">\(\beta_n\)</span>, la probabilidad de que el individuo <span class="math inline">\(n\)</span> elija la alternativa <span class="math inline">\(i\)</span> es simplemente un logit estándar:</p>
<p><span class="math display" id="eq:condlogit">\[\begin{equation}
L_{nit}(\beta_n) = \frac{\exp(\beta&#39;_n x_{nit})}{\sum_{j=1}^J \exp(\beta&#39;_n x_{njt})}
\tag{3.47}
\end{equation}\]</span></p>
<p>Sin embargo, como <span class="math inline">\(\beta_n\)</span> no es observable, la probabilidad <strong>no condicional</strong> de elección se obtiene integrando sobre la distribución de <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display" id="eq:mixedprob">\[\begin{equation}
P_{nit} = \int L_{nit}(\beta) f(\beta | \theta) d\beta = \int \frac{\exp(\beta&#39; x_{nit})}{\sum_{j=1}^J \exp(\beta&#39; x_{njt})} f(\beta | \theta) d\beta
\tag{3.48}
\end{equation}\]</span></p>
<p>Esta integral <strong>no tiene solución cerrada</strong> en general, lo que distingue fundamentalmente al mixed logit del logit estándar y requiere métodos de simulación para su estimación. La idea básica es aproximar la integral usando simulación de Monte Carlo:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Extraer valores aleatorios:</strong> Para cada individuo <span class="math inline">\(n\)</span>, se extraen <span class="math inline">\(R\)</span> valores de <span class="math inline">\(\beta\)</span> de la distribución especificada <span class="math inline">\(f(\beta|\theta)\)</span>: <span class="math inline">\(\beta^{(1)}, \beta^{(2)}, ..., \beta^{(R)}\)</span></p></li>
<li><p><strong>Calcular logit condicional:</strong> Para cada extracción <span class="math inline">\(r\)</span>, se calcula la probabilidad logit condicional:
<span class="math display">\[L_{nit}(\beta^{(r)}) = \frac{\exp(\beta^{(r)&#39;} x_{nit})}{\sum_j \exp(\beta^{(r)&#39;} x_{njt})}\]</span></p></li>
<li><p><strong>Promediar:</strong> La probabilidad simulada es el promedio sobre las <span class="math inline">\(R\)</span> extracciones:
<span class="math display" id="eq:simprob">\[\begin{equation}
\tilde{P}_{nit} = \frac{1}{R} \sum_{r=1}^R L_{nit}(\beta^{(r)})
\tag{3.23}
\end{equation}\]</span></p></li>
</ol>
<p>La probabilidad simulada <span class="math inline">\(\tilde{P}_{nit}\)</span> es un <strong>estimador insesgado</strong> de la verdadera probabilidad <span class="math inline">\(P_{nit}\)</span> y por la ley de los grandes números, <span class="math inline">\(\tilde{P}_{nit} \to P_{nit}\)</span> cuando <span class="math inline">\(R \to \infty\)</span>.</p>
<p>La log-verosimilitud simulada viene dada por:</p>
<p><span class="math display" id="eq:simll">\[\begin{equation}
SLL(\theta) = \sum_{n=1}^N \sum_{t=1}^T \sum_{i=1}^J y_{nit} \ln(\tilde{P}_{nit})
\tag{3.49}
\end{equation}\]</span></p>
<p>El <strong>estimador de máxima verosimilitud simulada (MSLE)</strong> maximiza esta función:</p>
<p><span class="math display">\[\hat{\theta}_{MSL} = \arg\max_\theta SLL(\theta)\]</span></p>
<p><strong>Propiedades asintóticas:</strong>
- Si <span class="math inline">\(R\)</span> crece más rápido que <span class="math inline">\(\sqrt{N}\)</span>, el MSLE es consistente, asintóticamente normal y asintóticamente eficiente
- En la práctica, valores de <span class="math inline">\(R\)</span> entre 100 y 500 suelen ser suficientes</p>
<p>La elección de la distribución <span class="math inline">\(f(\beta|\theta)\)</span> es crucial y debe basarse tanto en consideraciones teóricas como prácticas:</p>
<p><strong>Distribuciones Comunes:</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Normal:</strong> <span class="math inline">\(\beta_k \sim N(b_k, \sigma^2_k)\)</span>
<ul>
<li>Permite valores positivos y negativos</li>
<li>Apropiada cuando no hay restricciones de signo (ej: efectos de marca)</li>
</ul></li>
<li><strong>Log-Normal:</strong> <span class="math inline">\(\beta_k \sim LN(b_k, \sigma^2_k)\)</span>, es decir <span class="math inline">\(\ln(\beta_k) \sim N(b_k, \sigma^2_k)\)</span>
<ul>
<li>Garantiza que <span class="math inline">\(\beta_k &gt; 0\)</span> (útil para tiempo, costo)</li>
<li><strong>Limitación:</strong> No permite valores negativos</li>
</ul></li>
<li><strong>Normal Truncada:</strong> Normal restringida a cierto rango
<ul>
<li>Útil cuando la teoría sugiere un signo pero se quiere flexibilidad</li>
<li>Ejemplo: coeficiente de precio debe ser negativo</li>
</ul></li>
<li><strong>Uniforme:</strong> <span class="math inline">\(\beta_k \sim U[a_k, b_k]\)</span>
<ul>
<li>Útil cuando se conocen límites naturales</li>
<li>Menos común en aplicaciones de marketing</li>
</ul></li>
</ol>
<p>Es posible especificar correlaciones entre coeficientes aleatorios usando distribuciones multivariadas. Por ejemplo, con distribución normal multivariada:</p>
<p><span class="math display">\[\beta_n \sim N(b, \Sigma_\beta)\]</span></p>
</div>
<div id="descomposición-de-parámetros" class="section level4 hasAnchor" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> Descomposición de Parámetros<a href="modelos-estructurales.html#descomposición-de-parámetros" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Es común especificar el modelo de manera que algunos parámetros sean fijos (iguales para todos los individuos) y otros sean aleatorios. Por ejemplo:</p>
<p><span class="math display" id="eq:betadecomp">\[\begin{equation}
\beta_n = b + \eta_n
\tag{3.50}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(b\)</span> representa las preferencias medias de la población y <span class="math inline">\(\eta_n \sim N(0, \Sigma_\beta)\)</span> captura las desviaciones individuales respecto a estas preferencias medias.</p>
<p>Sustituyendo en la utilidad:</p>
<span class="math display">\[\begin{aligned}
u_{nit} &amp;= (b + \eta_n)&#39; x_{nit} + \varepsilon_{nit}\\
&amp;= b&#39; x_{nit} + \eta&#39;_n x_{nit} + \varepsilon_{nit}\\
&amp;= b&#39; x_{nit} + \tilde{\varepsilon}_{nit}
\end{aligned}\]</span>
<p>donde <span class="math inline">\(\tilde{\varepsilon}_{nit} = \eta&#39;_n x_{nit} + \varepsilon_{nit}\)</span> es la componente de error compuesta.</p>
</div>
</div>
<div id="propiedades-del-mixed-logit" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Propiedades del Mixed Logit<a href="modelos-estructurales.html#propiedades-del-mixed-logit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El modelo mixed logit posee propiedades notables que lo hacen extremadamente flexible:</p>
<div id="aproximación-universal" class="section level4 hasAnchor" number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Aproximación Universal<a href="modelos-estructurales.html#aproximación-universal" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Resultado fundamental (McFadden y Train, 2000):</strong> Cualquier modelo de utilidad aleatoria (RUM) puede ser aproximado arbitrariamente bien por un modelo mixed logit, siempre que se especifique apropiadamente la distribución de los coeficientes aleatorios.</p>
<p>Esto significa que el mixed logit puede aproximar patrones de sustitución arbitrarios, incluyendo aquellos del modelo probit multinomial, eliminando las restricciones del IIA cuando sea necesario.</p>
</div>
<div id="patrones-de-sustitución-flexibles" class="section level4 hasAnchor" number="3.5.3.2">
<h4><span class="header-section-number">3.5.3.2</span> Patrones de Sustitución Flexibles<a href="modelos-estructurales.html#patrones-de-sustitución-flexibles" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A diferencia del logit estándar, el mixed logit permite patrones de sustitución no proporcionales. La elasticidad cruzada entre alternativas depende de:</p>
<ul>
<li>Sus características específicas</li>
<li>La correlación entre sus utilidades inducida por los coeficientes aleatorios</li>
<li>La distribución de preferencias en la población</li>
</ul>
<p><strong>Ejemplo:</strong> Si dos alternativas comparten muchos atributos que tienen coeficientes aleatorios correlacionados, serán sustitutos más cercanos que alternativas con atributos diferentes.</p>
</div>
<div id="captura-de-heterogeneidad-no-observable" class="section level4 hasAnchor" number="3.5.3.3">
<h4><span class="header-section-number">3.5.3.3</span> Captura de heterogeneidad no observable<a href="modelos-estructurales.html#captura-de-heterogeneidad-no-observable" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El mixed logit permite modelar explícitamente que individuos con características observables idénticas pueden tener preferencias diferentes. La distribución <span class="math inline">\(f(\beta|\theta)\)</span> caracteriza cómo se distribuyen las preferencias en la población.</p>
<p><strong>Interpretación:</strong></p>
<ul>
<li>La <strong>media</strong> <span class="math inline">\(b\)</span> representa la preferencia promedio de la población</li>
<li>La <strong>desviación estándar</strong> <span class="math inline">\(\sigma_\beta\)</span> captura el grado de heterogeneidad en preferencias</li>
<li>Las <strong>covarianzas</strong> capturan relaciones sistemáticas entre preferencias (ej: quienes valoran más la velocidad también valoran más el confort)</li>
</ul>
</div>
<div id="correlación-temporal-y-entre-alternativas" class="section level4 hasAnchor" number="3.5.3.4">
<h4><span class="header-section-number">3.5.3.4</span> Correlación Temporal y Entre Alternativas<a href="modelos-estructurales.html#correlación-temporal-y-entre-alternativas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Al observar decisiones repetidas del mismo individuo, el mixed logit permite correlación entre las utilidades a través del tiempo porque <span class="math inline">\(\beta_n\)</span> es constante para el individuo <span class="math inline">\(n\)</span> a lo largo de sus decisiones.</p>
<p>Si se observa al individuo <span class="math inline">\(n\)</span> en <span class="math inline">\(T\)</span> ocasiones y se define <span class="math inline">\(y_{nit} = 1\)</span> si elige alternativa <span class="math inline">\(i\)</span> en ocasión <span class="math inline">\(t\)</span> y 0 en caso contrario, la probabilidad condicional de la secuencia completa de elecciones es:</p>
<p><span class="math display" id="eq:seqprob">\[\begin{equation}
L_n(\beta_n) = \prod_{t=1}^T \prod_{i=1}^J L_{nit}(\beta_n)^{y_{nit}} = \prod_{t=1}^T \left[\frac{\exp(\beta&#39;_n x_{nit})}{\sum_j \exp(\beta&#39;_n x_{njt})}\right]^{y_{nit}}
\tag{3.51}
\end{equation}\]</span></p>
<p>Y la probabilidad no condicional es:</p>
<p><span class="math display" id="eq:panelprob">\[\begin{equation}
P_n = \int L_n(\beta) f(\beta|\theta) d\beta
\tag{3.52}
\end{equation}\]</span></p>
<p>Esta estructura captura naturalmente que las elecciones del mismo individuo están correlacionadas debido a sus preferencias subyacentes <span class="math inline">\(\beta_n\)</span>.</p>
</div>
</div>
<div id="disposición-a-pagar-willingness-to-pay" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Disposición a Pagar (Willingness to Pay)<a href="modelos-estructurales.html#disposición-a-pagar-willingness-to-pay" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un beneficio importante del mixed logit es que permite derivar la distribución de la <strong>disposición a pagar (DAP)</strong> por diferentes atributos.</p>
<p>Si la utilidad es lineal: <span class="math inline">\(u_{nit} = \beta_{n,precio} \cdot precio_{it} + \beta_{n,atributo} \cdot atributo_{it} + ...\)</span></p>
<p>La DAP por una unidad adicional del atributo es:</p>
<p><span class="math display" id="eq:wtp">\[\begin{equation}
DAP_n = -\frac{\beta_{n,atributo}}{\beta_{n,precio}}
\tag{3.53}
\end{equation}\]</span></p>
<p>Como ambos <span class="math inline">\(\beta_{n,atributo}\)</span> y <span class="math inline">\(\beta_{n,precio}\)</span> son aleatorios, la DAP también tiene una distribución en la población. El mixed logit permite:</p>
<ol style="list-style-type: decimal">
<li>Estimar la <strong>distribución de la DAP</strong> en la población</li>
<li>Calcular estadísticos como la DAP media, mediana, percentiles</li>
<li>Identificar segmentos con alta/baja DAP</li>
</ol>
<p>Si ambos coeficientes son normales, la DAP sigue una distribución de Cauchy (que puede tener momentos no definidos). Esto ha llevado a usar especificaciones alternativas como log-normal para el coeficiente de precio.</p>
</div>
<div id="inferencia-individual-conditionalposterior-means" class="section level3 hasAnchor" number="3.5.5">
<h3><span class="header-section-number">3.5.5</span> Inferencia Individual: Conditional/Posterior Means<a href="modelos-estructurales.html#inferencia-individual-conditionalposterior-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una aplicación valiosa del mixed logit es la posibilidad de hacer <strong>inferencia individual</strong> sobre los parámetros <span class="math inline">\(\beta_n\)</span> de cada persona, incluso cuando estos no son directamente observables.</p>
<p>Usando el <strong>Teorema de Bayes</strong>, se puede calcular la distribución <strong>posterior</strong> de <span class="math inline">\(\beta_n\)</span> dado el historial de elecciones del individuo <span class="math inline">\(n\)</span>:</p>
<p><span class="math display" id="eq:posterior">\[\begin{equation}
h(\beta_n | y_n, \theta) = \frac{L_n(\beta_n) f(\beta_n | \theta)}{\int L_n(\beta) f(\beta | \theta) d\beta}
\tag{3.54}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(y_n\)</span> representa todas las elecciones observadas del individuo <span class="math inline">\(n\)</span>.</p>
<p>La <strong>media condicional</strong> (o posterior) es:</p>
<p><span class="math display" id="eq:condmean">\[\begin{equation}
\bar{\beta}_n = E[\beta_n | y_n, \theta] = \int \beta \cdot h(\beta | y_n, \theta) d\beta
\tag{3.55}
\end{equation}\]</span></p>
<p>Esta integral también se aproxima por simulación:</p>
<p><span class="math display" id="eq:simcondmean">\[\begin{equation}
\tilde{\bar{\beta}}_n = \frac{\sum_{r=1}^R \beta^{(r)} L_n(\beta^{(r)})}{\sum_{r=1}^R L_n(\beta^{(r)})}
\tag{3.56}
\end{equation}\]</span></p>
<p>Tiene aplicaciones en:</p>
<ul>
<li><strong>Personalización:</strong> Usar <span class="math inline">\(\bar{\beta}_n\)</span> para hacer recomendaciones personalizadas</li>
<li><strong>Segmentación:</strong> Agrupar individuos con <span class="math inline">\(\bar{\beta}_n\)</span> similares</li>
<li><strong>Targeting:</strong> Identificar individuos con alta probabilidad de responder a cierta oferta</li>
</ul>
</div>
<div id="ejemplo-1" class="section level3 hasAnchor" number="3.5.6">
<h3><span class="header-section-number">3.5.6</span> Ejemplo<a href="modelos-estructurales.html#ejemplo-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sea el caso de la elección de una marca de yogur (3 marcas: A, B, C) con datos de panel en el tiempo. Las variables que se disponen son:</p>
<ul>
<li><span class="math inline">\(precio_{nit}\)</span>: precio de marca <span class="math inline">\(i\)</span> para individuo <span class="math inline">\(n\)</span> en ocasión <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(display_{nit}\)</span>: indicadora de display especial</li>
<li><span class="math inline">\(marca_i\)</span>: indicadoras de marca (efectos fijos de marca)</li>
</ul>
<p>La especificación del modelo corresponda a:</p>
<span class="math display">\[\begin{aligned}
u_{nit} &amp;= \alpha_i + \beta_{n,precio} \cdot precio_{nit} + \beta_{display} \cdot display_{nit} + \varepsilon_{nit}\\
\beta_{n,precio} &amp;\sim N(b_{precio}, \sigma^2_{precio})
\end{aligned}\]</span>
<p>En un caso hipotético, donde se estima que <span class="math inline">\(b_{precio} = -2.5\)</span> y <span class="math inline">\(\sigma_{precio} = 1.0\)</span>:</p>
<ul>
<li>El consumidor promedio tiene sensibilidad al precio de -2.5</li>
<li>Hay heterogeneidad sustancial: aprox. 68% de consumidores (equivalente a una desviación estándar) tienen sensibilidad entre -3.5 y -1.5</li>
<li>Aproximadamente 1% de consumidores, calculado con la distribución normal acumulada para <span class="math inline">\(b_{precio} = -2.5\)</span>, podrían tener sensibilidad positiva, ya que prefieren productos caros.</li>
</ul>
<p>El DAP por un display se calcula como:</p>
<p><span class="math display">\[DAP_{display} = -\frac{\beta_{display}}{\beta_{n,precio}}\]</span></p>
<p>Si <span class="math inline">\(\beta_{display} = 0.5\)</span>, la DAP media sería aproximadamente <span class="math inline">\(0.5/2.5 = 0.20\)</span> dólares.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-probabilísticos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="apéndices-técnicos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rstudio/bookdown-demo/edit/master/03-estructurales.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
